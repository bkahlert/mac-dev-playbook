{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/webextension-polyfill/dist/browser-polyfill.js","webpack:///./src/lib/url.js","webpack:///./src/options/Keybindings/trie.js","webpack:///./src/storage/transform.js","webpack:///./src/options/General/index.js","webpack:///./src/options/Keybindings/index.js","webpack:///./src/options/Appearance/index.js","webpack:///./src/options/Blacklist/index.js","webpack:///./src/storage/procedures.js","webpack:///./node_modules/compare-versions/index.js","webpack:///./src/lib/dom.js","webpack:///./src/storage/storage.js","webpack:///./src/lib/keys.js","webpack:///./src/lib/util.js","webpack:///./node_modules/mosi/client.js","webpack:///./node_modules/mosi/core.js","webpack:///./src/background_page/modes.js","webpack:///./src/modes/command/background/commands/tab.js","webpack:///./src/modes/command/background/commands/clipboard.js","webpack:///./src/modes/command/background/index.js","webpack:///./src/modes/hints/background/index.js","webpack:///./src/modes/hints/background/hintStrings.js","webpack:///./src/background_page/index.js","webpack:///./node_modules/mosi/node.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","globalThis","self","browser","getPrototypeOf","CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE","SEND_RESPONSE_DEPRECATION_WARNING","wrapAPIs","extensionAPIs","apiMetadata","keys","length","Error","DefaultWeakMap","WeakMap","createItem","items","super","this","has","set","makeCallback","promise","metadata","callbackArgs","runtime","lastError","reject","singleCallbackArg","resolve","pluralizeArguments","numArgs","wrapMethod","target","method","wrapper","Proxy","apply","targetMethod","thisObj","args","Function","wrapObject","wrappers","cache","handlers","proxyTarget","prop","receiver","minArgs","maxArgs","Promise","fallbackToNoCallback","cbError","console","warn","noCallback","wrapAsyncFunction","configurable","desc","Reflect","deleteProperty","wrapEvent","wrapperMap","listener","addListener","hasListener","removeListener","loggedSendResponseDeprecationWarning","onMessageWrappers","message","sender","sendResponse","wrappedSendResponse","result","didCallSendResponse","sendResponsePromise","response","stack","err","isResultThenable","then","sendPromisedResult","msg","error","__mozWebExtensionPolyfillReject__","catch","wrappedSendMessageCallback","reply","wrappedSendMessage","apiNamespaceObj","wrappedCb","push","sendMessage","staticWrappers","onMessage","onMessageExternal","tabs","settingMetadata","clear","privacy","network","services","websites","chrome","id","isURL","str","URL","e","searchURL","query","queryURLTemplate","url","trim","indexOf","search","protocol","match","slice","protocolMatch","text","knownProtocols","replace","hasPath","test","split","isIP","every","knownTLDs","isTLD","isLikeURL","encodedSearchQuery","encodeURIComponent","lastIndexOf","searchEngineQueryURL","generateCommandTrie","commandMap","bindings","trie","forEach","binding","addToTrie","hasProp","firstLeafValue","type","command1","command2","JSONTrie","bindingsMap","out","command","entries","undefined","keySequence","map","validKeyboardEvent","keyboardEventString","bindingsList","transforms","General","options","config","backgroundOptions","getAttributes","clientOptions","errors","Keybindings","hintChars","setKeyboardSettings","physicalKeys","ignoreModifierKeys","keybindings","item","keybindingsPerMode","Appearance","hintUseCustomCSS","hintCSS","hintOpacity","hintFontFamily","hintFontWeight","hintHorizontalPadding","hintVerticalPadding","hintBorderWidth","hintFontSize","hintTextColor","hintBackgroundColor","hintBorderColor","hintShadow","hintBorderRadius","hintHorizontalPlacement","hintVerticalPlacement","hintHorizontalTranslation","hintVerticalTranslation","generateHintCSS","hintNormalCharCSS","hintActiveCharCSS","Blacklist","categories","transformOptions","allOptions","allBackgroundOptions","allClientOptions","allErrors","category","transform","assign","async","storageInstallProcedure","storageSet","ready","createCategories","createConfig","createBuiltInProfiles","storageGet","customProfiles","createCustomProfiles","activeProfiles","createActiveProfiles","createBuiltInOptions","storageUpdateProcedure","previousVersion","compareVersions","storageClear","builtInProfiles","profile","deleteBuiltInOptions","storageRemove","deleteBuiltInProfiles","deleteConfig","deleteCategories","_builtInProfiles","_customProfiles","_activeProfile","customProfile","newProfileName","Date","now","renameCustomProfilesAndOptions","correctActiveProfiles","correctedOptions","correctCustomOptions","storageImportProcedure","input","document","createElement","setAttribute","addEventListener","reader","FileReader","onload","storageResetProcedure","profiles","JSON","parse","readAsText","files","click","storageExportProcedure","downloadJSON","installCategories","request","fetch","json","newOptions","configItem","default","semver","v","q","patchIndex","arr","substring","tryParse","isNaN","Number","validate","version","TypeError","v1","v2","s1","s2","Math","max","n1","parseInt","n2","sp1","sp2","p1","p2","allowedOperators","operatorResMap","compare","operator","op","join","validateOperator","res","isTextEditable","element","nodeName","disabled","readonly","isEditableHTMLInput","contentEditable","toUpperCase","role","deepActiveElement","root","activeElement","activeElementShadowRoot","shadowRoot","mouseEvent","modifierKeys","events","event","MouseEvent","bubbles","cancelable","view","window","detail","dispatchEvent","fullscreenchange","normalizeEventType","copy","textArea","style","body","appendChild","select","execCommand","removeChild","paste","focus","filename","createObjectURL","Blob","stringify","downloads","download","saveAs","storage","local","remove","getAllActiveProfileOptions","activeOptions","isMac","navigator","appVersion","_physicalKeys","_ignoreModifierKeys","isModifierKey","modifierString","shiftKey","ctrlKey","altKey","a","metaKey","code","friendlyKeyboardEventString","friendlyModifierString","friendlyCodeStrings","friendlyShiftlessModifierString","simplify","repeat","posMod","output","Client","arguments","timeout","transactions","init","subscriptions","onConnect","onDisconnect","actions","log","onClientDisconnect","initLogging","connect","port","disconnect","subs","connectionInfo","disconnectListener","messageListener","dst","action","arg","actionHandler","postMessage","_getLocal","localId","src","_getRemote","tid","new","complete","node","connectionsByPort","Map","connectionsById","nextId","add","tabId","tab","frameId","connection","data","delete","withTmpConnection","callback","getByPort","getById","connections","onC","onD","executeOnConnectionActions","actionDetails","_msg","getTargets","targetSelf","targets","closed","includes","getStringTargets","values","filter","subDst","condition","tabCondition","frameCondition","idCondition","conditionMet","_get","localResult","remoteResults","all","meta","connectionId","mosi_lw_msg","modes","defaultModeObject","onOptionsChange","messages","reloadAllClients","isTabExecutable","executeScript","file","allFrames","runAt","matchAboutBlank","EXTENSION_PROTOCOL","getURL","startsWith","cachedClientOptions","onReplaced","addedTabId","removedTabId","onChanged","nextTab","currentWindow","activeTabIndex","findIndex","active","nextTabId","update","previousTab","previousTabId","firstTab","firstTabId","lastTab","lastTabId","moveTabLeft","move","index","moveTabRight","nextTabIndex","moveTabFirst","moveTabLast","moveTabNewWindow","windows","closeTab","closeOtherTabs","closeRightTabs","closeLeftTabs","newTab","restoreTab","sessions","restore","duplicateTab","duplicate","duplicateTabIncognito","incognito","incognitoWindows","getAll","windowTypes","w","windowId","state","newWindow","newIncognitoWindow","switchWindow","zoomIn","zoomFactor","getZoom","setZoom","min","zoomStep","zoomOut","zoomReset","refreshTab","reload","refreshAllTabs","hardRefreshTab","bypassCache","toggleMuteTab","muted","mutedInfo","toggleMuteAllTabs","togglePinTab","pinned","clipboardCurrentTab","clipboardBackgroundTab","clipboardForegroundTab","clipboardNewWindow","clipboardIncognitoWindow","tabCommands","clipboardCommands","autoActivateHint","findHints","currentTabTarget","hintsPerFrame","totalHints","reduce","total","find","nextMode","hintStrings","characters","count","hints","offset","hint","generateHintStrings","nextOffset","processKey","results","openLinkInIncognitoWindow","loadClient","_","tabIndex","SAKA_DEBUG","availableModes","initModes","Command","Hints","onInstalled","reason","setup","DEFAULT_TIMEOUT","Transactions","timer","setTimeout","transaction","clearTimeout","Node","handler","tx_or_rx","arg_or_res","arg_str","tid_str"],"mappings":"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ACA,KACA,QACA,OACA,OACA,KACA,OACA,aACA,KACA,WACA,KACA,UACA,QACA,QACA,KACA,KACA,MACA,KACA,KACA,OACA,OACA,MACA,cACA,WACA,WACA,SACA,KACA,KACA,KACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,MACA,OACA,MACA,MACA,KACA,QACA,cACA,YACA,OACA,KACA,MACA,KACA,aACA,KACA,MACA,WACA,KACA,WACA,KACA,KACA,WACA,QACA,WACA,WACA,OACA,KACA,KACA,KACA,KACA,MACA,KACA,MACA,MACA,SACA,OACA,iBACA,WACA,UACA,UACA,QACA,OACA,SACA,UACA,UACA,OACA,OACA,MACA,WACA,KACA,KACA,SACA,MACA,OACA,KACA,KACA,KACA,UACA,QACA,YACA,SACA,SACA,KACA,QACA,OACA,KACA,KACA,SACA,WACA,QACA,SACA,WACA,OACA,KACA,KACA,KACA,QACA,QACA,SACA,UACA,UACA,MACA,YACA,UACA,WACA,SACA,eACA,aACA,cACA,UACA,OACA,OACA,UACA,KACA,SACA,aACA,UACA,MACA,UACA,KACA,aACA,KACA,KACA,KACA,KACA,QACA,KACA,QACA,MACA,QACA,SACA,MACA,OACA,KACA,QACA,SACA,WACA,WACA,SACA,UACA,OACA,SACA,MACA,WACA,OACA,UACA,SACA,YACA,WACA,KACA,KACA,KACA,MACA,KACA,OACA,UACA,SACA,SACA,OACA,KACA,MACA,KACA,MACA,YACA,KACA,KACA,QACA,SACA,SACA,WACA,cACA,cACA,YACA,KACA,KACA,MACA,SACA,KACA,KACA,aACA,MACA,SACA,WACA,WACA,SACA,UACA,OACA,OACA,UACA,WACA,KACA,UACA,YACA,WACA,OACA,UACA,MACA,UACA,KACA,KACA,UACA,UACA,UACA,WACA,MACA,KACA,KACA,MACA,UACA,aACA,KACA,MACA,UACA,OACA,YACA,SACA,KACA,MACA,UACA,SACA,KACA,OACA,KACA,KACA,OACA,KACA,KACA,OACA,KACA,KACA,OACA,QACA,QACA,KACA,QACA,MACA,SACA,QACA,KACA,QACA,MACA,MACA,KACA,OACA,SACA,MACA,MACA,KACA,KACA,KACA,WACA,SACA,QACA,QACA,KACA,KACA,KACA,QACA,UACA,OACA,KACA,KACA,UACA,UACA,OACA,aACA,OACA,OACA,SACA,SACA,MACA,KACA,KACA,KACA,WACA,UACA,QACA,QACA,OACA,UACA,QACA,MACA,KACA,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,OACA,aACA,KACA,aACA,OACA,MACA,MACA,YACA,SACA,MACA,gBACA,cACA,KACA,KACA,KACA,QACA,KACA,KACA,MACA,MACA,KACA,QACA,KACA,KACA,OACA,SACA,KACA,SACA,SACA,OACA,KACA,KACA,KACA,KACA,MACA,UACA,OACA,KACA,KACA,QACA,KACA,KACA,MACA,OACA,KACA,KACA,QACA,KACA,KACA,UACA,OACA,MACA,UACA,SACA,KACA,KACA,MACA,QACA,QACA,OACA,KACA,OACA,OACA,WACA,UACA,OACA,OACA,KACA,QACA,SACA,QACA,QACA,KACA,KACA,KACA,OACA,KACA,OACA,SACA,KACA,KACA,KACA,SACA,SACA,aACA,QACA,SACA,YACA,WACA,KACA,KACA,KACA,QACA,OACA,YACA,OACA,WACA,OACA,KACA,KACA,QACA,MACA,OACA,KACA,KACA,KACA,KACA,KACA,OACA,OACA,MACA,SACA,QACA,SACA,WACA,SACA,cACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,SACA,KACA,KACA,KACA,KACA,KACA,KACA,SACA,OACA,OACA,KACA,KACA,MACA,UACA,UACA,MACA,QACA,KACA,KACA,MACA,MACA,KACA,QACA,KACA,KACA,KACA,KACA,MACA,MACA,KACA,MACA,KACA,UACA,KACA,MACA,MACA,MACA,MACA,MACA,UACA,QACA,SACA,MACA,KACA,QACA,WACA,QACA,QACA,KACA,KACA,KACA,KACA,WACA,QACA,cACA,SACA,SACA,OACA,WACA,OACA,QACA,KACA,KACA,QACA,WACA,KACA,KACA,OACA,QACA,OACA,OACA,KACA,QACA,QACA,MACA,OACA,cACA,OACA,aACA,WACA,KACA,KACA,MACA,KACA,KACA,KACA,OACA,SACA,KACA,UACA,UACA,MACA,QACA,QACA,SACA,OACA,MACA,UACA,SACA,SACA,aACA,OACA,aACA,UACA,OACA,MACA,MACA,KACA,QACA,QACA,KACA,OACA,KACA,OACA,KACA,SACA,KACA,WACA,OACA,UACA,OACA,KACA,KACA,MACA,MACA,UACA,SACA,UACA,UACA,OACA,KACA,KACA,WACA,MACA,OACA,KACA,KACA,UACA,QACA,UACA,KACA,UACA,KACA,KACA,MACA,KACA,KACA,KACA,KACA,SACA,WACA,OACA,QACA,YACA,MACA,QACA,UACA,KACA,KACA,KACA,WACA,SACA,UACA,OACA,UACA,SACA,KACA,KACA,KACA,SACA,UACA,KACA,SACA,QACA,SACA,MACA,KACA,KACA,aACA,MACA,UACA,KACA,KACA,KACA,SACA,OACA,QACA,QACA,KACA,KACA,KACA,KACA,KACA,KACA,QACA,QACA,QACA,MACA,OACA,OACA,KACA,KACA,QACA,WACA,SACA,QACA,KACA,MACA,KACA,KACA,KACA,KACA,KACA,KACA,aACA,MACA,MACA,KACA,KACA,KACA,KACA,YACA,KACA,KACA,QACA,WACA,eACA,MACA,KACA,KACA,SACA,QACA,SACA,SACA,aACA,KACA,QACA,OACA,SACA,OACA,SACA,KACA,QACA,OACA,QACA,SACA,UACA,MACA,UACA,KACA,UACA,OACA,OACA,cACA,MACA,OACA,QACA,QACA,KACA,MACA,MACA,cACA,cACA,cACA,eACA,cACA,aACA,aACA,cACA,aACA,cACA,iBACA,eACA,cACA,eACA,aACA,aACA,iBACA,YACA,aACA,yBACA,cACA,aACA,aACA,cACA,YACA,iBACA,aACA,aACA,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","file":"background_page.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 76);\n","(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(\"webextension-polyfill\", [\"module\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(module);\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(mod);\n    global.browser = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (module) {\n  /* webextension-polyfill - v0.6.0 - Mon Dec 23 2019 12:32:53 */\n\n  /* -*- Mode: indent-tabs-mode: nil; js-indent-level: 2 -*- */\n\n  /* vim: set sts=2 sw=2 et tw=80: */\n\n  /* This Source Code Form is subject to the terms of the Mozilla Public\n   * License, v. 2.0. If a copy of the MPL was not distributed with this\n   * file, You can obtain one at http://mozilla.org/MPL/2.0/. */\n  \"use strict\";\n\n  if (typeof browser === \"undefined\" || Object.getPrototypeOf(browser) !== Object.prototype) {\n    const CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE = \"The message port closed before a response was received.\";\n    const SEND_RESPONSE_DEPRECATION_WARNING = \"Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)\"; // Wrapping the bulk of this polyfill in a one-time-use function is a minor\n    // optimization for Firefox. Since Spidermonkey does not fully parse the\n    // contents of a function until the first time it's called, and since it will\n    // never actually need to be called, this allows the polyfill to be included\n    // in Firefox nearly for free.\n\n    const wrapAPIs = extensionAPIs => {\n      // NOTE: apiMetadata is associated to the content of the api-metadata.json file\n      // at build time by replacing the following \"include\" with the content of the\n      // JSON file.\n      const apiMetadata = {\n        \"alarms\": {\n          \"clear\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"clearAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"bookmarks\": {\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getChildren\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getRecent\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getSubTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTree\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeTree\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"browserAction\": {\n          \"disable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"enable\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"getBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"openPopup\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setBadgeBackgroundColor\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setBadgeText\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"browsingData\": {\n          \"remove\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"removeCache\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCookies\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeDownloads\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFormData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeHistory\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeLocalStorage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePasswords\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removePluginData\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"settings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"commands\": {\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"contextMenus\": {\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"cookies\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAllCookieStores\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"set\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"devtools\": {\n          \"inspectedWindow\": {\n            \"eval\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 2,\n              \"singleCallbackArg\": false\n            }\n          },\n          \"panels\": {\n            \"create\": {\n              \"minArgs\": 3,\n              \"maxArgs\": 3,\n              \"singleCallbackArg\": true\n            }\n          }\n        },\n        \"downloads\": {\n          \"cancel\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"download\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"erase\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFileIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"open\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"pause\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeFile\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"resume\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"extension\": {\n          \"isAllowedFileSchemeAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"isAllowedIncognitoAccess\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"history\": {\n          \"addUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"deleteRange\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"deleteUrl\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getVisits\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"search\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"i18n\": {\n          \"detectLanguage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAcceptLanguages\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"identity\": {\n          \"launchWebAuthFlow\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"idle\": {\n          \"queryState\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"management\": {\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"setEnabled\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"uninstallSelf\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"notifications\": {\n          \"clear\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPermissionLevel\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        },\n        \"pageAction\": {\n          \"getPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"hide\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setIcon\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"setPopup\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"setTitle\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          },\n          \"show\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1,\n            \"fallbackToNoCallback\": true\n          }\n        },\n        \"permissions\": {\n          \"contains\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"request\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"runtime\": {\n          \"getBackgroundPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getPlatformInfo\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"openOptionsPage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"requestUpdateCheck\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"sendMessage\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 3\n          },\n          \"sendNativeMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"setUninstallURL\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"sessions\": {\n          \"getDevices\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getRecentlyClosed\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"restore\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          }\n        },\n        \"storage\": {\n          \"local\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          },\n          \"managed\": {\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            }\n          },\n          \"sync\": {\n            \"clear\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 0\n            },\n            \"get\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"getBytesInUse\": {\n              \"minArgs\": 0,\n              \"maxArgs\": 1\n            },\n            \"remove\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            },\n            \"set\": {\n              \"minArgs\": 1,\n              \"maxArgs\": 1\n            }\n          }\n        },\n        \"tabs\": {\n          \"captureVisibleTab\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"create\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"detectLanguage\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"discard\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"duplicate\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"executeScript\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          },\n          \"getZoom\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getZoomSettings\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"highlight\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"insertCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"move\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          },\n          \"query\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"reload\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 2\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"removeCSS\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"sendMessage\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 3\n          },\n          \"setZoom\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"setZoomSettings\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"update\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          }\n        },\n        \"topSites\": {\n          \"get\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"webNavigation\": {\n          \"getAllFrames\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"getFrame\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          }\n        },\n        \"webRequest\": {\n          \"handlerBehaviorChanged\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 0\n          }\n        },\n        \"windows\": {\n          \"create\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"get\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 2\n          },\n          \"getAll\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getCurrent\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"getLastFocused\": {\n            \"minArgs\": 0,\n            \"maxArgs\": 1\n          },\n          \"remove\": {\n            \"minArgs\": 1,\n            \"maxArgs\": 1\n          },\n          \"update\": {\n            \"minArgs\": 2,\n            \"maxArgs\": 2\n          }\n        }\n      };\n\n      if (Object.keys(apiMetadata).length === 0) {\n        throw new Error(\"api-metadata.json has not been included in browser-polyfill\");\n      }\n      /**\n       * A WeakMap subclass which creates and stores a value for any key which does\n       * not exist when accessed, but behaves exactly as an ordinary WeakMap\n       * otherwise.\n       *\n       * @param {function} createItem\n       *        A function which will be called in order to create the value for any\n       *        key which does not exist, the first time it is accessed. The\n       *        function receives, as its only argument, the key being created.\n       */\n\n\n      class DefaultWeakMap extends WeakMap {\n        constructor(createItem, items = undefined) {\n          super(items);\n          this.createItem = createItem;\n        }\n\n        get(key) {\n          if (!this.has(key)) {\n            this.set(key, this.createItem(key));\n          }\n\n          return super.get(key);\n        }\n\n      }\n      /**\n       * Returns true if the given object is an object with a `then` method, and can\n       * therefore be assumed to behave as a Promise.\n       *\n       * @param {*} value The value to test.\n       * @returns {boolean} True if the value is thenable.\n       */\n\n\n      const isThenable = value => {\n        return value && typeof value === \"object\" && typeof value.then === \"function\";\n      };\n      /**\n       * Creates and returns a function which, when called, will resolve or reject\n       * the given promise based on how it is called:\n       *\n       * - If, when called, `chrome.runtime.lastError` contains a non-null object,\n       *   the promise is rejected with that value.\n       * - If the function is called with exactly one argument, the promise is\n       *   resolved to that value.\n       * - Otherwise, the promise is resolved to an array containing all of the\n       *   function's arguments.\n       *\n       * @param {object} promise\n       *        An object containing the resolution and rejection functions of a\n       *        promise.\n       * @param {function} promise.resolve\n       *        The promise's resolution function.\n       * @param {function} promise.rejection\n       *        The promise's rejection function.\n       * @param {object} metadata\n       *        Metadata about the wrapped method which has created the callback.\n       * @param {integer} metadata.maxResolvedArgs\n       *        The maximum number of arguments which may be passed to the\n       *        callback created by the wrapped async function.\n       *\n       * @returns {function}\n       *        The generated callback function.\n       */\n\n\n      const makeCallback = (promise, metadata) => {\n        return (...callbackArgs) => {\n          if (extensionAPIs.runtime.lastError) {\n            promise.reject(extensionAPIs.runtime.lastError);\n          } else if (metadata.singleCallbackArg || callbackArgs.length <= 1 && metadata.singleCallbackArg !== false) {\n            promise.resolve(callbackArgs[0]);\n          } else {\n            promise.resolve(callbackArgs);\n          }\n        };\n      };\n\n      const pluralizeArguments = numArgs => numArgs == 1 ? \"argument\" : \"arguments\";\n      /**\n       * Creates a wrapper function for a method with the given name and metadata.\n       *\n       * @param {string} name\n       *        The name of the method which is being wrapped.\n       * @param {object} metadata\n       *        Metadata about the method being wrapped.\n       * @param {integer} metadata.minArgs\n       *        The minimum number of arguments which must be passed to the\n       *        function. If called with fewer than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {integer} metadata.maxArgs\n       *        The maximum number of arguments which may be passed to the\n       *        function. If called with more than this number of arguments, the\n       *        wrapper will raise an exception.\n       * @param {integer} metadata.maxResolvedArgs\n       *        The maximum number of arguments which may be passed to the\n       *        callback created by the wrapped async function.\n       *\n       * @returns {function(object, ...*)}\n       *       The generated wrapper function.\n       */\n\n\n      const wrapAsyncFunction = (name, metadata) => {\n        return function asyncFunctionWrapper(target, ...args) {\n          if (args.length < metadata.minArgs) {\n            throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          if (args.length > metadata.maxArgs) {\n            throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n          }\n\n          return new Promise((resolve, reject) => {\n            if (metadata.fallbackToNoCallback) {\n              // This API method has currently no callback on Chrome, but it return a promise on Firefox,\n              // and so the polyfill will try to call it with a callback first, and it will fallback\n              // to not passing the callback if the first call fails.\n              try {\n                target[name](...args, makeCallback({\n                  resolve,\n                  reject\n                }, metadata));\n              } catch (cbError) {\n                console.warn(`${name} API method doesn't seem to support the callback parameter, ` + \"falling back to call it without a callback: \", cbError);\n                target[name](...args); // Update the API method metadata, so that the next API calls will not try to\n                // use the unsupported callback anymore.\n\n                metadata.fallbackToNoCallback = false;\n                metadata.noCallback = true;\n                resolve();\n              }\n            } else if (metadata.noCallback) {\n              target[name](...args);\n              resolve();\n            } else {\n              target[name](...args, makeCallback({\n                resolve,\n                reject\n              }, metadata));\n            }\n          });\n        };\n      };\n      /**\n       * Wraps an existing method of the target object, so that calls to it are\n       * intercepted by the given wrapper function. The wrapper function receives,\n       * as its first argument, the original `target` object, followed by each of\n       * the arguments passed to the original method.\n       *\n       * @param {object} target\n       *        The original target object that the wrapped method belongs to.\n       * @param {function} method\n       *        The method being wrapped. This is used as the target of the Proxy\n       *        object which is created to wrap the method.\n       * @param {function} wrapper\n       *        The wrapper function which is called in place of a direct invocation\n       *        of the wrapped method.\n       *\n       * @returns {Proxy<function>}\n       *        A Proxy object for the given method, which invokes the given wrapper\n       *        method in its place.\n       */\n\n\n      const wrapMethod = (target, method, wrapper) => {\n        return new Proxy(method, {\n          apply(targetMethod, thisObj, args) {\n            return wrapper.call(thisObj, target, ...args);\n          }\n\n        });\n      };\n\n      let hasOwnProperty = Function.call.bind(Object.prototype.hasOwnProperty);\n      /**\n       * Wraps an object in a Proxy which intercepts and wraps certain methods\n       * based on the given `wrappers` and `metadata` objects.\n       *\n       * @param {object} target\n       *        The target object to wrap.\n       *\n       * @param {object} [wrappers = {}]\n       *        An object tree containing wrapper functions for special cases. Any\n       *        function present in this object tree is called in place of the\n       *        method in the same location in the `target` object tree. These\n       *        wrapper methods are invoked as described in {@see wrapMethod}.\n       *\n       * @param {object} [metadata = {}]\n       *        An object tree containing metadata used to automatically generate\n       *        Promise-based wrapper functions for asynchronous. Any function in\n       *        the `target` object tree which has a corresponding metadata object\n       *        in the same location in the `metadata` tree is replaced with an\n       *        automatically-generated wrapper function, as described in\n       *        {@see wrapAsyncFunction}\n       *\n       * @returns {Proxy<object>}\n       */\n\n      const wrapObject = (target, wrappers = {}, metadata = {}) => {\n        let cache = Object.create(null);\n        let handlers = {\n          has(proxyTarget, prop) {\n            return prop in target || prop in cache;\n          },\n\n          get(proxyTarget, prop, receiver) {\n            if (prop in cache) {\n              return cache[prop];\n            }\n\n            if (!(prop in target)) {\n              return undefined;\n            }\n\n            let value = target[prop];\n\n            if (typeof value === \"function\") {\n              // This is a method on the underlying object. Check if we need to do\n              // any wrapping.\n              if (typeof wrappers[prop] === \"function\") {\n                // We have a special-case wrapper for this method.\n                value = wrapMethod(target, target[prop], wrappers[prop]);\n              } else if (hasOwnProperty(metadata, prop)) {\n                // This is an async method that we have metadata for. Create a\n                // Promise wrapper for it.\n                let wrapper = wrapAsyncFunction(prop, metadata[prop]);\n                value = wrapMethod(target, target[prop], wrapper);\n              } else {\n                // This is a method that we don't know or care about. Return the\n                // original method, bound to the underlying object.\n                value = value.bind(target);\n              }\n            } else if (typeof value === \"object\" && value !== null && (hasOwnProperty(wrappers, prop) || hasOwnProperty(metadata, prop))) {\n              // This is an object that we need to do some wrapping for the children\n              // of. Create a sub-object wrapper for it with the appropriate child\n              // metadata.\n              value = wrapObject(value, wrappers[prop], metadata[prop]);\n            } else if (hasOwnProperty(metadata, \"*\")) {\n              // Wrap all properties in * namespace.\n              value = wrapObject(value, wrappers[prop], metadata[\"*\"]);\n            } else {\n              // We don't need to do any wrapping for this property,\n              // so just forward all access to the underlying object.\n              Object.defineProperty(cache, prop, {\n                configurable: true,\n                enumerable: true,\n\n                get() {\n                  return target[prop];\n                },\n\n                set(value) {\n                  target[prop] = value;\n                }\n\n              });\n              return value;\n            }\n\n            cache[prop] = value;\n            return value;\n          },\n\n          set(proxyTarget, prop, value, receiver) {\n            if (prop in cache) {\n              cache[prop] = value;\n            } else {\n              target[prop] = value;\n            }\n\n            return true;\n          },\n\n          defineProperty(proxyTarget, prop, desc) {\n            return Reflect.defineProperty(cache, prop, desc);\n          },\n\n          deleteProperty(proxyTarget, prop) {\n            return Reflect.deleteProperty(cache, prop);\n          }\n\n        }; // Per contract of the Proxy API, the \"get\" proxy handler must return the\n        // original value of the target if that value is declared read-only and\n        // non-configurable. For this reason, we create an object with the\n        // prototype set to `target` instead of using `target` directly.\n        // Otherwise we cannot return a custom object for APIs that\n        // are declared read-only and non-configurable, such as `chrome.devtools`.\n        //\n        // The proxy handlers themselves will still use the original `target`\n        // instead of the `proxyTarget`, so that the methods and properties are\n        // dereferenced via the original targets.\n\n        let proxyTarget = Object.create(target);\n        return new Proxy(proxyTarget, handlers);\n      };\n      /**\n       * Creates a set of wrapper functions for an event object, which handles\n       * wrapping of listener functions that those messages are passed.\n       *\n       * A single wrapper is created for each listener function, and stored in a\n       * map. Subsequent calls to `addListener`, `hasListener`, or `removeListener`\n       * retrieve the original wrapper, so that  attempts to remove a\n       * previously-added listener work as expected.\n       *\n       * @param {DefaultWeakMap<function, function>} wrapperMap\n       *        A DefaultWeakMap object which will create the appropriate wrapper\n       *        for a given listener function when one does not exist, and retrieve\n       *        an existing one when it does.\n       *\n       * @returns {object}\n       */\n\n\n      const wrapEvent = wrapperMap => ({\n        addListener(target, listener, ...args) {\n          target.addListener(wrapperMap.get(listener), ...args);\n        },\n\n        hasListener(target, listener) {\n          return target.hasListener(wrapperMap.get(listener));\n        },\n\n        removeListener(target, listener) {\n          target.removeListener(wrapperMap.get(listener));\n        }\n\n      }); // Keep track if the deprecation warning has been logged at least once.\n\n\n      let loggedSendResponseDeprecationWarning = false;\n      const onMessageWrappers = new DefaultWeakMap(listener => {\n        if (typeof listener !== \"function\") {\n          return listener;\n        }\n        /**\n         * Wraps a message listener function so that it may send responses based on\n         * its return value, rather than by returning a sentinel value and calling a\n         * callback. If the listener function returns a Promise, the response is\n         * sent when the promise either resolves or rejects.\n         *\n         * @param {*} message\n         *        The message sent by the other end of the channel.\n         * @param {object} sender\n         *        Details about the sender of the message.\n         * @param {function(*)} sendResponse\n         *        A callback which, when called with an arbitrary argument, sends\n         *        that value as a response.\n         * @returns {boolean}\n         *        True if the wrapped listener returned a Promise, which will later\n         *        yield a response. False otherwise.\n         */\n\n\n        return function onMessage(message, sender, sendResponse) {\n          let didCallSendResponse = false;\n          let wrappedSendResponse;\n          let sendResponsePromise = new Promise(resolve => {\n            wrappedSendResponse = function (response) {\n              if (!loggedSendResponseDeprecationWarning) {\n                console.warn(SEND_RESPONSE_DEPRECATION_WARNING, new Error().stack);\n                loggedSendResponseDeprecationWarning = true;\n              }\n\n              didCallSendResponse = true;\n              resolve(response);\n            };\n          });\n          let result;\n\n          try {\n            result = listener(message, sender, wrappedSendResponse);\n          } catch (err) {\n            result = Promise.reject(err);\n          }\n\n          const isResultThenable = result !== true && isThenable(result); // If the listener didn't returned true or a Promise, or called\n          // wrappedSendResponse synchronously, we can exit earlier\n          // because there will be no response sent from this listener.\n\n          if (result !== true && !isResultThenable && !didCallSendResponse) {\n            return false;\n          } // A small helper to send the message if the promise resolves\n          // and an error if the promise rejects (a wrapped sendMessage has\n          // to translate the message into a resolved promise or a rejected\n          // promise).\n\n\n          const sendPromisedResult = promise => {\n            promise.then(msg => {\n              // send the message value.\n              sendResponse(msg);\n            }, error => {\n              // Send a JSON representation of the error if the rejected value\n              // is an instance of error, or the object itself otherwise.\n              let message;\n\n              if (error && (error instanceof Error || typeof error.message === \"string\")) {\n                message = error.message;\n              } else {\n                message = \"An unexpected error occurred\";\n              }\n\n              sendResponse({\n                __mozWebExtensionPolyfillReject__: true,\n                message\n              });\n            }).catch(err => {\n              // Print an error on the console if unable to send the response.\n              console.error(\"Failed to send onMessage rejected reply\", err);\n            });\n          }; // If the listener returned a Promise, send the resolved value as a\n          // result, otherwise wait the promise related to the wrappedSendResponse\n          // callback to resolve and send it as a response.\n\n\n          if (isResultThenable) {\n            sendPromisedResult(result);\n          } else {\n            sendPromisedResult(sendResponsePromise);\n          } // Let Chrome know that the listener is replying.\n\n\n          return true;\n        };\n      });\n\n      const wrappedSendMessageCallback = ({\n        reject,\n        resolve\n      }, reply) => {\n        if (extensionAPIs.runtime.lastError) {\n          // Detect when none of the listeners replied to the sendMessage call and resolve\n          // the promise to undefined as in Firefox.\n          // See https://github.com/mozilla/webextension-polyfill/issues/130\n          if (extensionAPIs.runtime.lastError.message === CHROME_SEND_MESSAGE_CALLBACK_NO_RESPONSE_MESSAGE) {\n            resolve();\n          } else {\n            reject(extensionAPIs.runtime.lastError);\n          }\n        } else if (reply && reply.__mozWebExtensionPolyfillReject__) {\n          // Convert back the JSON representation of the error into\n          // an Error instance.\n          reject(new Error(reply.message));\n        } else {\n          resolve(reply);\n        }\n      };\n\n      const wrappedSendMessage = (name, metadata, apiNamespaceObj, ...args) => {\n        if (args.length < metadata.minArgs) {\n          throw new Error(`Expected at least ${metadata.minArgs} ${pluralizeArguments(metadata.minArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        if (args.length > metadata.maxArgs) {\n          throw new Error(`Expected at most ${metadata.maxArgs} ${pluralizeArguments(metadata.maxArgs)} for ${name}(), got ${args.length}`);\n        }\n\n        return new Promise((resolve, reject) => {\n          const wrappedCb = wrappedSendMessageCallback.bind(null, {\n            resolve,\n            reject\n          });\n          args.push(wrappedCb);\n          apiNamespaceObj.sendMessage(...args);\n        });\n      };\n\n      const staticWrappers = {\n        runtime: {\n          onMessage: wrapEvent(onMessageWrappers),\n          onMessageExternal: wrapEvent(onMessageWrappers),\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 1,\n            maxArgs: 3\n          })\n        },\n        tabs: {\n          sendMessage: wrappedSendMessage.bind(null, \"sendMessage\", {\n            minArgs: 2,\n            maxArgs: 3\n          })\n        }\n      };\n      const settingMetadata = {\n        clear: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        get: {\n          minArgs: 1,\n          maxArgs: 1\n        },\n        set: {\n          minArgs: 1,\n          maxArgs: 1\n        }\n      };\n      apiMetadata.privacy = {\n        network: {\n          \"*\": settingMetadata\n        },\n        services: {\n          \"*\": settingMetadata\n        },\n        websites: {\n          \"*\": settingMetadata\n        }\n      };\n      return wrapObject(extensionAPIs, staticWrappers, apiMetadata);\n    };\n\n    if (typeof chrome != \"object\" || !chrome || !chrome.runtime || !chrome.runtime.id) {\n      throw new Error(\"This script should only be loaded in a browser extension.\");\n    } // The build process adds a UMD wrapper around this file, which makes the\n    // `module` variable available.\n\n\n    module.exports = wrapAPIs(chrome);\n  } else {\n    module.exports = browser;\n  }\n});\n//# sourceMappingURL=browser-polyfill.js.map\n","/**\n * Returns true only if str is a valid url\n * @param {string} str\n */\nexport function isURL (str) {\n  try {\n    // eslint-disable-next-line no-new\n    new URL(str)\n  } catch (e) {\n    return false\n  }\n  return true\n}\n\nexport function stripProtocol (url) {\n  return url.replace(/(^\\w+:|^)\\/\\//, '')\n}\n\nexport function stripWWW (url) {\n  return url.replace(/^www\\./, '')\n}\n\nexport function startsWithProtocol (str) {\n  return str.match(/(^\\w+:|^)\\/\\//) !== null\n}\n\nexport function startsWithWWW (str) {\n  return str.match(/^www\\./, '') !== null\n}\n\n/**\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L51\n */\nexport function searchURL (\n  query,\n  queryURLTemplate = 'https://www.google.com/search?q='\n) {\n  return isLikeURL(query)\n    ? (!/^[a-zA-Z-]+:/.test(query) ? 'https://' : '') + query\n    : searchEngineQueryURL(query, queryURLTemplate)\n}\n\n/**\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L45\n */\nexport function searchEngineQueryURL (query, queryURLTemplate) {\n  const encodedSearchQuery = encodeURIComponent(query)\n  const i = queryURLTemplate.lastIndexOf('%s')\n  return i < 0\n    ? `${queryURLTemplate}${encodedSearchQuery}`\n    : `${queryURLTemplate.slice(\n        0,\n        i\n      )}${encodedSearchQuery}${queryURLTemplate.slice(i + 2)}`\n}\n\n/**\n * Returns true if the text is a valid URL (including protocol, e.g. https://hello)\n * or probably corresponds to a valid URL (e.g. google.com)\n * Based on https://github.com/1995eaton/chromium-vim/blob/aec10cf47943b4674a5bc92c46d3c3c138d3cba3/content_scripts/utils.js#L59\n */\nexport function isLikeURL (url) {\n  url = url.trim()\n  if (url.indexOf(' ') !== -1) {\n    return false\n  }\n  if (url.search(/^(about|file):[^:]/) !== -1) {\n    return true\n  }\n  const protocol = (url.match(/^([a-zA-Z-]+:)[^:]/) || [''])[0].slice(0, -1)\n  const protocolMatch = isProtocol(protocol)\n  if (protocolMatch) {\n    url = url.replace(/^[a-zA-Z-]+:\\/*/, '')\n  }\n  const hasPath = /.*[a-zA-Z].*\\//.test(url)\n  url = url.replace(/(:[0-9]+)?([#/].*|$)/g, '').split('.')\n  if (protocolMatch && /^[a-zA-Z0-9@!]+$/.test(url)) {\n    return true\n  }\n  if (protocol && !protocolMatch && protocol !== 'localhost:') {\n    return false\n  }\n  // IP addresses\n  const isIP = url.every(e => /^[0-9]+$/.test(e) && +e >= 0 && +e < 256)\n  if ((isIP && !protocol && url.length === 4) || (isIP && protocolMatch)) {\n    return true\n  }\n  return (\n    (url.every(e => /^[a-z0-9-]+$/i.test(e)) &&\n      url.length > 1 && isTLD(url[url.length - 1])) ||\n    (url.length === 1 && url[0] === 'localhost') ||\n    hasPath\n  )\n}\n\nconst knownTLDs = [\n  'abogado',\n  'ac',\n  'academy',\n  'accountants',\n  'active',\n  'actor',\n  'ad',\n  'adult',\n  'ae',\n  'aero',\n  'af',\n  'ag',\n  'agency',\n  'ai',\n  'airforce',\n  'al',\n  'allfinanz',\n  'alsace',\n  'am',\n  'amsterdam',\n  'an',\n  'android',\n  'ao',\n  'aq',\n  'aquarelle',\n  'ar',\n  'archi',\n  'army',\n  'arpa',\n  'as',\n  'asia',\n  'associates',\n  'at',\n  'attorney',\n  'au',\n  'auction',\n  'audio',\n  'autos',\n  'aw',\n  'ax',\n  'axa',\n  'az',\n  'ba',\n  'band',\n  'bank',\n  'bar',\n  'barclaycard',\n  'barclays',\n  'bargains',\n  'bayern',\n  'bb',\n  'bd',\n  'be',\n  'beer',\n  'berlin',\n  'best',\n  'bf',\n  'bg',\n  'bh',\n  'bi',\n  'bid',\n  'bike',\n  'bio',\n  'biz',\n  'bj',\n  'black',\n  'blackfriday',\n  'bloomberg',\n  'blue',\n  'bm',\n  'bmw',\n  'bn',\n  'bnpparibas',\n  'bo',\n  'boo',\n  'boutique',\n  'br',\n  'brussels',\n  'bs',\n  'bt',\n  'budapest',\n  'build',\n  'builders',\n  'business',\n  'buzz',\n  'bv',\n  'bw',\n  'by',\n  'bz',\n  'bzh',\n  'ca',\n  'cab',\n  'cal',\n  'camera',\n  'camp',\n  'cancerresearch',\n  'capetown',\n  'capital',\n  'caravan',\n  'cards',\n  'care',\n  'career',\n  'careers',\n  'cartier',\n  'casa',\n  'cash',\n  'cat',\n  'catering',\n  'cc',\n  'cd',\n  'center',\n  'ceo',\n  'cern',\n  'cf',\n  'cg',\n  'ch',\n  'channel',\n  'cheap',\n  'christmas',\n  'chrome',\n  'church',\n  'ci',\n  'citic',\n  'city',\n  'ck',\n  'cl',\n  'claims',\n  'cleaning',\n  'click',\n  'clinic',\n  'clothing',\n  'club',\n  'cm',\n  'cn',\n  'co',\n  'coach',\n  'codes',\n  'coffee',\n  'college',\n  'cologne',\n  'com',\n  'community',\n  'company',\n  'computer',\n  'condos',\n  'construction',\n  'consulting',\n  'contractors',\n  'cooking',\n  'cool',\n  'coop',\n  'country',\n  'cr',\n  'credit',\n  'creditcard',\n  'cricket',\n  'crs',\n  'cruises',\n  'cu',\n  'cuisinella',\n  'cv',\n  'cw',\n  'cx',\n  'cy',\n  'cymru',\n  'cz',\n  'dabur',\n  'dad',\n  'dance',\n  'dating',\n  'day',\n  'dclk',\n  'de',\n  'deals',\n  'degree',\n  'delivery',\n  'democrat',\n  'dental',\n  'dentist',\n  'desi',\n  'design',\n  'dev',\n  'diamonds',\n  'diet',\n  'digital',\n  'direct',\n  'directory',\n  'discount',\n  'dj',\n  'dk',\n  'dm',\n  'dnp',\n  'do',\n  'docs',\n  'domains',\n  'doosan',\n  'durban',\n  'dvag',\n  'dz',\n  'eat',\n  'ec',\n  'edu',\n  'education',\n  'ee',\n  'eg',\n  'email',\n  'emerck',\n  'energy',\n  'engineer',\n  'engineering',\n  'enterprises',\n  'equipment',\n  'er',\n  'es',\n  'esq',\n  'estate',\n  'et',\n  'eu',\n  'eurovision',\n  'eus',\n  'events',\n  'everbank',\n  'exchange',\n  'expert',\n  'exposed',\n  'fail',\n  'farm',\n  'fashion',\n  'feedback',\n  'fi',\n  'finance',\n  'financial',\n  'firmdale',\n  'fish',\n  'fishing',\n  'fit',\n  'fitness',\n  'fj',\n  'fk',\n  'flights',\n  'florist',\n  'flowers',\n  'flsmidth',\n  'fly',\n  'fm',\n  'fo',\n  'foo',\n  'forsale',\n  'foundation',\n  'fr',\n  'frl',\n  'frogans',\n  'fund',\n  'furniture',\n  'futbol',\n  'ga',\n  'gal',\n  'gallery',\n  'garden',\n  'gb',\n  'gbiz',\n  'gd',\n  'ge',\n  'gent',\n  'gf',\n  'gg',\n  'ggee',\n  'gh',\n  'gi',\n  'gift',\n  'gifts',\n  'gives',\n  'gl',\n  'glass',\n  'gle',\n  'global',\n  'globo',\n  'gm',\n  'gmail',\n  'gmo',\n  'gmx',\n  'gn',\n  'goog',\n  'google',\n  'gop',\n  'gov',\n  'gp',\n  'gq',\n  'gr',\n  'graphics',\n  'gratis',\n  'green',\n  'gripe',\n  'gs',\n  'gt',\n  'gu',\n  'guide',\n  'guitars',\n  'guru',\n  'gw',\n  'gy',\n  'hamburg',\n  'hangout',\n  'haus',\n  'healthcare',\n  'help',\n  'here',\n  'hermes',\n  'hiphop',\n  'hiv',\n  'hk',\n  'hm',\n  'hn',\n  'holdings',\n  'holiday',\n  'homes',\n  'horse',\n  'host',\n  'hosting',\n  'house',\n  'how',\n  'hr',\n  'ht',\n  'hu',\n  'ibm',\n  'id',\n  'ie',\n  'ifm',\n  'il',\n  'im',\n  'immo',\n  'immobilien',\n  'in',\n  'industries',\n  'info',\n  'ing',\n  'ink',\n  'institute',\n  'insure',\n  'int',\n  'international',\n  'investments',\n  'io',\n  'iq',\n  'ir',\n  'irish',\n  'is',\n  'it',\n  'iwc',\n  'jcb',\n  'je',\n  'jetzt',\n  'jm',\n  'jo',\n  'jobs',\n  'joburg',\n  'jp',\n  'juegos',\n  'kaufen',\n  'kddi',\n  'ke',\n  'kg',\n  'kh',\n  'ki',\n  'kim',\n  'kitchen',\n  'kiwi',\n  'km',\n  'kn',\n  'koeln',\n  'kp',\n  'kr',\n  'krd',\n  'kred',\n  'kw',\n  'ky',\n  'kyoto',\n  'kz',\n  'la',\n  'lacaixa',\n  'land',\n  'lat',\n  'latrobe',\n  'lawyer',\n  'lb',\n  'lc',\n  'lds',\n  'lease',\n  'legal',\n  'lgbt',\n  'li',\n  'lidl',\n  'life',\n  'lighting',\n  'limited',\n  'limo',\n  'link',\n  'lk',\n  'loans',\n  'london',\n  'lotte',\n  'lotto',\n  'lr',\n  'ls',\n  'lt',\n  'ltda',\n  'lu',\n  'luxe',\n  'luxury',\n  'lv',\n  'ly',\n  'ma',\n  'madrid',\n  'maison',\n  'management',\n  'mango',\n  'market',\n  'marketing',\n  'marriott',\n  'mc',\n  'md',\n  'me',\n  'media',\n  'meet',\n  'melbourne',\n  'meme',\n  'memorial',\n  'menu',\n  'mg',\n  'mh',\n  'miami',\n  'mil',\n  'mini',\n  'mk',\n  'ml',\n  'mm',\n  'mn',\n  'mo',\n  'mobi',\n  'moda',\n  'moe',\n  'monash',\n  'money',\n  'mormon',\n  'mortgage',\n  'moscow',\n  'motorcycles',\n  'mov',\n  'mp',\n  'mq',\n  'mr',\n  'ms',\n  'mt',\n  'mu',\n  'museum',\n  'mv',\n  'mw',\n  'mx',\n  'my',\n  'mz',\n  'na',\n  'nagoya',\n  'name',\n  'navy',\n  'nc',\n  'ne',\n  'net',\n  'network',\n  'neustar',\n  'new',\n  'nexus',\n  'nf',\n  'ng',\n  'ngo',\n  'nhk',\n  'ni',\n  'ninja',\n  'nl',\n  'no',\n  'np',\n  'nr',\n  'nra',\n  'nrw',\n  'nu',\n  'nyc',\n  'nz',\n  'okinawa',\n  'om',\n  'one',\n  'ong',\n  'onl',\n  'ooo',\n  'org',\n  'organic',\n  'osaka',\n  'otsuka',\n  'ovh',\n  'pa',\n  'paris',\n  'partners',\n  'parts',\n  'party',\n  'pe',\n  'pf',\n  'pg',\n  'ph',\n  'pharmacy',\n  'photo',\n  'photography',\n  'photos',\n  'physio',\n  'pics',\n  'pictures',\n  'pink',\n  'pizza',\n  'pk',\n  'pl',\n  'place',\n  'plumbing',\n  'pm',\n  'pn',\n  'pohl',\n  'poker',\n  'porn',\n  'post',\n  'pr',\n  'praxi',\n  'press',\n  'pro',\n  'prod',\n  'productions',\n  'prof',\n  'properties',\n  'property',\n  'ps',\n  'pt',\n  'pub',\n  'pw',\n  'py',\n  'qa',\n  'qpon',\n  'quebec',\n  're',\n  'realtor',\n  'recipes',\n  'red',\n  'rehab',\n  'reise',\n  'reisen',\n  'reit',\n  'ren',\n  'rentals',\n  'repair',\n  'report',\n  'republican',\n  'rest',\n  'restaurant',\n  'reviews',\n  'rich',\n  'rio',\n  'rip',\n  'ro',\n  'rocks',\n  'rodeo',\n  'rs',\n  'rsvp',\n  'ru',\n  'ruhr',\n  'rw',\n  'ryukyu',\n  'sa',\n  'saarland',\n  'sale',\n  'samsung',\n  'sarl',\n  'sb',\n  'sc',\n  'sca',\n  'scb',\n  'schmidt',\n  'schule',\n  'schwarz',\n  'science',\n  'scot',\n  'sd',\n  'se',\n  'services',\n  'sew',\n  'sexy',\n  'sg',\n  'sh',\n  'shiksha',\n  'shoes',\n  'shriram',\n  'si',\n  'singles',\n  'sj',\n  'sk',\n  'sky',\n  'sl',\n  'sm',\n  'sn',\n  'so',\n  'social',\n  'software',\n  'sohu',\n  'solar',\n  'solutions',\n  'soy',\n  'space',\n  'spiegel',\n  'sr',\n  'st',\n  'su',\n  'supplies',\n  'supply',\n  'support',\n  'surf',\n  'surgery',\n  'suzuki',\n  'sv',\n  'sx',\n  'sy',\n  'sydney',\n  'systems',\n  'sz',\n  'taipei',\n  'tatar',\n  'tattoo',\n  'tax',\n  'tc',\n  'td',\n  'technology',\n  'tel',\n  'temasek',\n  'tf',\n  'tg',\n  'th',\n  'tienda',\n  'tips',\n  'tires',\n  'tirol',\n  'tj',\n  'tk',\n  'tl',\n  'tm',\n  'tn',\n  'to',\n  'today',\n  'tokyo',\n  'tools',\n  'top',\n  'town',\n  'toys',\n  'tp',\n  'tr',\n  'trade',\n  'training',\n  'travel',\n  'trust',\n  'tt',\n  'tui',\n  'tv',\n  'tw',\n  'tz',\n  'ua',\n  'ug',\n  'uk',\n  'university',\n  'uno',\n  'uol',\n  'us',\n  'uy',\n  'uz',\n  'va',\n  'vacations',\n  'vc',\n  've',\n  'vegas',\n  'ventures',\n  'versicherung',\n  'vet',\n  'vg',\n  'vi',\n  'viajes',\n  'video',\n  'villas',\n  'vision',\n  'vlaanderen',\n  'vn',\n  'vodka',\n  'vote',\n  'voting',\n  'voto',\n  'voyage',\n  'vu',\n  'wales',\n  'wang',\n  'watch',\n  'webcam',\n  'website',\n  'wed',\n  'wedding',\n  'wf',\n  'whoswho',\n  'wien',\n  'wiki',\n  'williamhill',\n  'wme',\n  'work',\n  'works',\n  'world',\n  'ws',\n  'wtc',\n  'wtf',\n  'xn--1qqw23a',\n  'xn--3bst00m',\n  'xn--3ds443g',\n  'xn--3e0b707e',\n  'xn--45brj9c',\n  'xn--45q11c',\n  'xn--4gbrim',\n  'xn--55qw42g',\n  'xn--55qx5d',\n  'xn--6frz82g',\n  'xn--6qq986b3xl',\n  'xn--80adxhks',\n  'xn--80ao21a',\n  'xn--80asehdb',\n  'xn--80aswg',\n  'xn--90a3ac',\n  'xn--b4w605ferd',\n  'xn--c1avg',\n  'xn--cg4bki',\n  'xn--clchc0ea0b2g2a9gcd',\n  'xn--czr694b',\n  'xn--czrs0t',\n  'xn--czru2d',\n  'xn--d1acj3b',\n  'xn--d1alf',\n  'xn--fiq228c5hs',\n  'xn--fiq64b',\n  'xn--fiqs8s',\n  'xn--fiqz9s',\n  'xn--flw351e',\n  'xn--fpcrj9c3d',\n  'xn--fzc2c9e2c',\n  'xn--gecrj9c',\n  'xn--h2brj9c',\n  'xn--hxt814e',\n  'xn--i1b6b1a6a2e',\n  'xn--io0a7i',\n  'xn--j1amh',\n  'xn--j6w193g',\n  'xn--kprw13d',\n  'xn--kpry57d',\n  'xn--kput3i',\n  'xn--l1acc',\n  'xn--lgbbat1ad8j',\n  'xn--mgb9awbf',\n  'xn--mgba3a4f16a',\n  'xn--mgbaam7a8h',\n  'xn--mgbab2bd',\n  'xn--mgbayh7gpa',\n  'xn--mgbbh1a71e',\n  'xn--mgbc0a9azcg',\n  'xn--mgberp4a5d4ar',\n  'xn--mgbx4cd0ab',\n  'xn--ngbc5azd',\n  'xn--node',\n  'xn--nqv7f',\n  'xn--nqv7fs00ema',\n  'xn--o3cw4h',\n  'xn--ogbpf8fl',\n  'xn--p1acf',\n  'xn--p1ai',\n  'xn--pgbs0dh',\n  'xn--q9jyb4c',\n  'xn--qcka1pmc',\n  'xn--rhqv96g',\n  'xn--s9brj9c',\n  'xn--ses554g',\n  'xn--unup4y',\n  'xn--vermgensberater-ctb',\n  'xn--vermgensberatung-pwb',\n  'xn--vhquv',\n  'xn--wgbh1c',\n  'xn--wgbl6a',\n  'xn--xhq521b',\n  'xn--xkc2al3hye2a',\n  'xn--xkc2dl3a5ee0h',\n  'xn--yfro4i67o',\n  'xn--ygbi2ammx',\n  'xn--zfr164b',\n  'xxx',\n  'xyz',\n  'yachts',\n  'yandex',\n  'ye',\n  'yoga',\n  'yokohama',\n  'YouTube',\n  'yt',\n  'za',\n  'zip',\n  'zm',\n  'zone',\n  'zuerich',\n  'zw'\n]\n/** Returns whether the provided text is a known TLD (top-level domain) */\nexport function isTLD (text) {\n  return knownTLDs.indexOf(text) !== -1\n}\n\nconst knownProtocols = [\n  'http:',\n  'https:',\n  'file:',\n  'ftp:',\n  'chrome:',\n  'chrome-extension:'\n]\n/** Returns whether the provided text is a known protocol */\nexport function isProtocol (text) {\n  return knownProtocols.indexOf(text) !== -1\n}\n","import { validKeyboardEvent, keyboardEventString } from 'lib/keys'\nimport { hasProp } from 'lib/util'\n\n/**\n * Given an object mapping commands to their key bindings,\n * returns the trie representation.\n */\nexport function generateCommandTrie (commandMap) {\n  return JSONTrie(bindingsList(commandMap))\n}\n\n/**\n * Given an object mapping commands to their key bindings,\n * returns an array of (commands, binding).\n * A command may have more than one binding, or none at all.\n */\nfunction bindingsList (bindingsMap) {\n  const out = []\n  for (const [command, bindings] of Object.entries(bindingsMap)) {\n    if (bindings === undefined) {\n      throw Error(`A profile is missing bindings for command ${command}`)\n    }\n    for (const binding of bindings) {\n      const keySequence = binding.map(key => {\n        try {\n          validKeyboardEvent(key)\n        } catch (e) {\n          throw Error(`Invalid KeyboardEvent descriptor for ${command}`)\n        }\n        return keyboardEventString(key)\n      })\n      out.push([keySequence, command, binding])\n    }\n  }\n  return out\n}\n\n/**\n * Given an array of (command, binding),\n * returns the trie representation.\n */\nfunction JSONTrie (bindings) {\n  const trie = {}\n  bindings.forEach(([key, value, binding]) => {\n    addToTrie(trie, 0, key, value, binding)\n  })\n  return trie\n}\n\nfunction addToTrie (trie, i, key, value, binding) {\n  if (key.length === 0) {\n    throw Error(`${value} has a 0 length key binding`)\n  } else if (i === key.length - 1) {\n    if (hasProp(trie, key[i])) {\n      // eslint-disable-next-line no-throw-literal\n      throw {\n        message: `${firstLeafValue(\n          trie[key[i]]\n        )} and ${value} have conflicting mapping`,\n        type: 'conflict',\n        command1: trie[key[i]],\n        command2: value\n      }\n    } else {\n      trie[key[i]] = value\n    }\n  } else {\n    if (hasProp(trie, key[i])) {\n      if (typeof trie[key[i]] === 'object') {\n        addToTrie(trie[key[i]], i + 1, key, value)\n      } else {\n        // eslint-disable-next-line no-throw-literal\n        throw {\n          message: `${trie[key[i]]} and ${value} have conflicting prefix`,\n          type: 'conflict',\n          command1: trie[key[i]],\n          command2: value\n        }\n      }\n    } else {\n      addToTrie((trie[key[i]] = {}), i + 1, key, value)\n    }\n  }\n}\n\nfunction firstLeafValue (trie) {\n  return typeof trie === 'object'\n    ? firstLeafValue(trie[Object.keys(trie)[0]])\n    : trie\n}\n","import transformGeneral from 'options/General'\nimport transformKeybindings from 'options/Keybindings'\nimport transformAppearance from 'options/Appearance'\nimport transformBlacklist from 'options/Blacklist'\nconst transforms = {\n  General: transformGeneral,\n  Keybindings: transformKeybindings,\n  Appearance: transformAppearance,\n  Blacklist: transformBlacklist\n}\nexport const categories = Object.keys(transforms)\n\n/**\n * Given a key-value map of options, applies and merges each per-category transform.\n * @param {{ [key: string]: any }} allOptions\n * @returns {{ backgroundOptions: { [key: string]: any }, clientOptions: { [key: string]: any }, errors: { [key: string]: any } }}\n */\nexport default function transformOptions (allOptions, config) {\n  const allBackgroundOptions = {}\n  const allClientOptions = {}\n  const allErrors = {}\n  Object.entries(transforms).forEach(([category, transform]) => {\n    const { clientOptions, backgroundOptions, errors } = transform(\n      allOptions,\n      config[category]\n    )\n    Object.assign(allClientOptions, clientOptions)\n    Object.assign(allBackgroundOptions, backgroundOptions)\n    Object.assign(allErrors, errors)\n  })\n  return {\n    backgroundOptions: allBackgroundOptions,\n    clientOptions: allClientOptions,\n    errors: allErrors\n  }\n}\n","import { getAttributes } from 'lib/util'\n\nexport default (options, config) => {\n  const backgroundOptions = getAttributes(options, ['autoActivateHint'])\n  const clientOptions = getAttributes(options, [\n    'enabled',\n    'preventStealFocus',\n    'hintDetectByCursorStyle',\n    'smoothScroll',\n    'scrollStep'\n  ])\n  const errors = {}\n  return { backgroundOptions, clientOptions, errors }\n}\n","import { generateCommandTrie } from './trie'\nimport { getAttributes } from 'lib/util'\nimport { setKeyboardSettings } from 'lib/keys'\n\nexport default (options, config) => {\n  const backgroundOptions = getAttributes(options, ['hintChars'])\n  const clientOptions = getAttributes(options, [\n    'physicalKeys',\n    'ignoreModifierKeys'\n  ])\n  const errors = {}\n  if (options.hintChars.length < 2) {\n    errors.hintChars = 'A minimum of two hint characters must be specified'\n  }\n  setKeyboardSettings(options.physicalKeys, options.ignoreModifierKeys)\n  const keybindings = keybindingsPerMode(options, config)\n  Object.entries(keybindings).forEach(([mode, bindings]) => {\n    try {\n      clientOptions[\n        mode ? `${mode}Bindings` : 'bindings'\n      ] = generateCommandTrie(bindings)\n    } catch (e) {\n      if (e.type === 'conflict') {\n        errors[e.command1] = e.message\n        errors[e.command2] = e.message\n      } else throw e\n    }\n  })\n  return { backgroundOptions, clientOptions, errors }\n}\n\nfunction keybindingsPerMode (options, config) {\n  const keybindings = {}\n  config.forEach(item => {\n    if (item.type === 'keybinding') {\n      const { mode = 'command', key } = item\n      if (keybindings[mode]) {\n        keybindings[mode][key] = options[key]\n      } else {\n        keybindings[mode] = { [key]: options[key] }\n      }\n    }\n  })\n  return keybindings\n}\n","import { getAttributes } from 'lib/util'\n\nexport default (options, config) => {\n  const backgroundOptions = {}\n  const clientOptions = getAttributes(options, [\n    'hintFontSize',\n    'hintUseTargetSize',\n    'hintCSS',\n    'hintNormalCharCSS',\n    'hintActiveCharCSS',\n    'hintHorizontalPlacement',\n    'hintVerticalPlacement'\n  ])\n  const errors = {}\n  if (options.hintUseCustomCSS) {\n    clientOptions.hintCSS = `all: initial; position: absolute; z-index: 999999999999; ${options.hintCSS}`\n  } else {\n    clientOptions.hintCSS = generateHintCSS(options)\n    clientOptions.hintNormalCharCSS = ''\n    clientOptions.hintActiveCharCSS = 'opacity: 0.5'\n  }\n  return { backgroundOptions, clientOptions, errors }\n}\n\n/**\n * Given input settings parameters, generates the CSS used to style link hints\n */\nfunction generateHintCSS ({\n  hintOpacity,\n  hintFontFamily,\n  hintFontWeight,\n  hintHorizontalPadding,\n  hintVerticalPadding,\n  hintBorderWidth,\n  hintFontSize,\n  hintTextColor,\n  hintBackgroundColor,\n  hintBorderColor,\n  hintShadow,\n  hintBorderRadius,\n  hintHorizontalPlacement,\n  hintVerticalPlacement,\n  hintHorizontalTranslation,\n  hintVerticalTranslation\n}) {\n  const translationX =\n    hintHorizontalTranslation +\n    (hintHorizontalPlacement === 'left'\n      ? 0\n      : hintHorizontalPlacement === 'right'\n        ? -100\n        : -50)\n  const translationY =\n    hintVerticalTranslation +\n    (hintVerticalPlacement === 'top'\n      ? 0\n      : hintVerticalPlacement === 'bottom'\n        ? -100\n        : -50)\n  return `all: initial;\nposition: absolute;\nz-index: 2147483647;\nopacity: ${hintOpacity};\nfont-family: ${hintFontFamily};\nfont-weight: ${hintFontWeight};\npadding: ${hintVerticalPadding}rem ${hintHorizontalPadding}rem;\nborder: ${hintBorderWidth}px solid;\ntext-align: center;\ntext-decoration: none;\ntext-transform: uppercase;\nvertical-align: middle;\nfont-size: ${hintFontSize}px;\ncolor: ${hintTextColor};\nbackground-color: ${hintBackgroundColor};\nborder-color: ${hintBorderColor};\n${\n  hintShadow\n    ? 'box-shadow: 0 3px 1px -2px rgba(0,0,0,.2), 0 2px 2px 0 rgba(0,0,0,.14), 0 1px 5px 0 rgba(0,0,0,.12);'\n    : ''\n}\nborder-radius: ${hintBorderRadius}px;\ntransform: translate3d(${translationX}%, ${translationY}%, 0)`\n}\n","import { getAttributes } from 'lib/util'\n\nexport default (options, config) => {\n  const backgroundOptions = getAttributes(options, ['blacklist'])\n  const clientOptions = getAttributes(options, ['blacklist'])\n  const errors = {}\n  return { backgroundOptions, clientOptions, errors }\n}\n","import {\n  storageGet,\n  storageSet,\n  storageRemove,\n  storageClear\n} from 'storage/storage'\nimport { hasProp } from 'lib/util'\nimport { msg } from 'mosi/client'\nimport { categories as installCategories } from 'storage/transform'\nimport { downloadJSON } from 'lib/dom'\nimport compareVersions from 'compare-versions'\n\n// TODO: test this code, lots of room for error, should really have unit tests\n\nexport async function storageInstallProcedure () {\n  try {\n    await storageSet({ ready: false })\n    await createCategories()\n    await createConfig()\n    if (SAKA_DEBUG) await validateConfig()\n    await createBuiltInProfiles()\n    await createCustomProfiles()\n    await createActiveProfiles()\n    await createBuiltInOptions()\n    await storageSet({ ready: true })\n  } catch (e) {\n    console.error(\n      'FATAL ERROR: INSTALLATION FAILED. DELETE THEN REINSTALL THE EXTENSION.',\n      e\n    )\n  }\n}\n\nexport async function storageUpdateProcedure (previousVersion) {\n  try {\n    // order matters: e.g. you must delete the old built-in options using the\n    // built-in profiles already in storage, not the built-in profiles in the update\n    await storageSet({ ready: false })\n    if (compareVersions(previousVersion, '1.16') <= 0) {\n      await storageClear()\n      await storageInstallProcedure()\n    } else {\n      await deleteBuiltInOptions()\n      await deleteBuiltInProfiles()\n      await deleteConfig()\n      await deleteCategories()\n      await createCategories()\n      await createConfig()\n      if (SAKA_DEBUG) await validateConfig()\n      await createBuiltInProfiles()\n      await renameCustomProfilesAndOptions() // if a new built-in profile 'steals' the name of an existing custom profile\n      await correctActiveProfiles() // if the active profile is a deleted built-in profile\n      await createBuiltInOptions()\n      await correctCustomOptions()\n    }\n    await storageSet({ ready: true })\n  } catch (e) {\n    console.error(\n      'FATAL ERROR: UPDATE FAILED. DELETE THEN REINSTALL THE EXTENSION.',\n      e\n    )\n  }\n}\n\n// TODO: proper import validation\nexport async function storageImportProcedure () {\n  const input = document.createElement('input')\n  input.setAttribute('type', 'file')\n  input.setAttribute('accept', '.json')\n  input.addEventListener('change', e => {\n    const reader = new FileReader()\n    reader.onload = async () => {\n      await storageResetProcedure()\n      const { customProfiles, options } = await storageGet([\n        'customProfiles',\n        'options'\n      ])\n      const { activeProfiles, profiles } = JSON.parse(reader.result)\n      for (const category in profiles) {\n        for (const profile in profiles[category]) {\n          customProfiles[category].push(profile)\n          options[`${category}_${profile}`] = profiles[category][profile]\n        }\n      }\n      await storageSet({ customProfiles, activeProfiles, options })\n      msg('options_page', 'RERENDER')\n    }\n    reader.readAsText(e.target.files[0])\n  })\n  input.click()\n}\n\nexport async function storageExportProcedure () {\n  const { customProfiles, activeProfiles, options } = await storageGet([\n    'customProfiles',\n    'activeProfiles',\n    'options'\n  ])\n  const profiles = {}\n  for (const category in customProfiles) {\n    profiles[category] = {}\n    customProfiles[category].forEach(profile => {\n      profiles[category][profile] = options[`${category}_${profile}`]\n    })\n  }\n  await downloadJSON({ activeProfiles, profiles }, 'saka_key_config.json')\n}\n\nexport async function storageResetProcedure () {\n  await storageClear()\n  await storageInstallProcedure()\n  msg('options_page', 'RERENDER')\n}\n\nasync function createCategories () {\n  await storageSet({ categories: installCategories })\n}\n\nasync function createConfig () {\n  const { categories } = await storageGet('categories')\n  const config = {}\n  for (const category of categories) {\n    const request = await fetch(`/config_${category}.json`)\n    const result = await request.json()\n    config[category] = result.options\n  }\n  await storageSet({ config })\n}\n\n// TODO: define a per-type validation function\nasync function validateConfig () {\n  const { config } = await storageGet('config')\n  const allKeys = {}\n  for (const [category, _config] of Object.entries(config)) {\n    for (const item of _config) {\n      if (!hasProp(item, 'type')) {\n        throw Error(\n          `Config validation failed: item ${category}:${item.key ||\n            '[no key]'} has no type`,\n          item\n        )\n      }\n      if (hasProp(item, 'key')) {\n        if (hasProp(allKeys, item.key)) {\n          throw Error(\n            `Config validation failed: two items share the key ${item.key}`\n          )\n        } else {\n          allKeys[item.key] = true\n        }\n        if (!hasProp(item, 'default')) {\n          throw Error(\n            `Config validation failed: no default value for key ${item.key}`\n          )\n        }\n      }\n    }\n  }\n}\n\nasync function createBuiltInProfiles () {\n  const { categories } = await storageGet('categories')\n  const builtInProfiles = {}\n  for (const category of categories) {\n    const request = await fetch(`/default_${category}.json`)\n    const { profiles } = await request.json()\n    builtInProfiles[category] = profiles.map(profile => profile.name)\n  }\n  await storageSet({ builtInProfiles })\n}\n\nasync function createCustomProfiles () {\n  const { categories } = await storageGet('categories')\n  const customProfiles = {}\n  for (const category of categories) {\n    customProfiles[category] = []\n  }\n  await storageSet({ customProfiles })\n}\n\nasync function createActiveProfiles () {\n  const { categories } = await storageGet('categories')\n  const activeProfiles = {}\n  for (const category of categories) {\n    activeProfiles[category] = 'default'\n  }\n  await storageSet({ activeProfiles })\n}\n\n/**\n * If options don't exist, creates them using the built-in profiles.\n * If options exist, adds built-in profile options.\n */\nasync function createBuiltInOptions () {\n  const { options = {} } = await storageGet('options')\n  const { categories } = await storageGet('categories')\n  for (const category of categories) {\n    const request = await fetch(`/default_${category}.json`)\n    const { profiles } = await request.json()\n    for (const profile of profiles) {\n      options[`${category}_${profile.name}`] = profile.options\n    }\n  }\n  await storageSet({ options })\n}\n\nasync function deleteBuiltInOptions () {\n  const { categories, options, builtInProfiles } = await storageGet([\n    'categories',\n    'options',\n    'builtInProfiles'\n  ])\n  for (const category of categories) {\n    for (const profile of builtInProfiles[category]) {\n      delete options[`${category}_${profile}`]\n    }\n  }\n  await storageSet({ options })\n}\n\nasync function deleteBuiltInProfiles () {\n  await storageRemove('builtInProfiles')\n}\n\nasync function deleteConfig () {\n  await storageRemove('config')\n}\n\n/**\n * Accounts for the case where a built-in profile introduced in an update conflicts with\n * a custom profile already installed. Renames the custom profile, active profile, and action\n * if a conflict is detected.\n */\nasync function renameCustomProfilesAndOptions () {\n  const {\n    categories,\n    customProfiles,\n    builtInProfiles,\n    activeProfiles,\n    options\n  } = await storageGet([\n    'categories',\n    'customProfiles',\n    'builtInProfiles',\n    'activeProfiles',\n    'options'\n  ])\n  for (const category of categories) {\n    const _builtInProfiles = builtInProfiles[category]\n    let _customProfiles = customProfiles[category]\n    const _activeProfile = activeProfiles[category]\n\n    if (_customProfiles === undefined) {\n      _customProfiles = _builtInProfiles\n    }\n\n    _customProfiles.forEach((customProfile, i) => {\n      if (_builtInProfiles.indexOf(customProfile) !== -1) {\n        // rename custom profile\n        const newProfileName = `${customProfile}_renamed_${Date.now()}`\n        _customProfiles[i] = newProfileName\n        // rename active profile\n        if (_activeProfile === customProfile) {\n          activeProfiles[category] = newProfileName\n        }\n        // rename options\n        options[`${category}_${newProfileName}`] =\n          options[`${category}_${customProfile}`]\n        delete options[`${category}_${customProfile}`]\n      }\n    })\n  }\n  await storageSet({ customProfiles, activeProfiles, options })\n}\n\nasync function deleteCategories () {\n  await storageRemove('categories')\n}\n/**\n * Accounts for the case where the active profile has been deleted\n */\nasync function correctActiveProfiles () {\n  const {\n    categories,\n    activeProfiles,\n    builtInProfiles,\n    customProfiles\n  } = await storageGet([\n    'categories',\n    'activeProfiles',\n    'builtInProfiles',\n    'customProfiles'\n  ])\n  for (const category of categories) {\n    if (customProfiles[category] === undefined) {\n      customProfiles[category] = builtInProfiles[category]\n    }\n    const profiles = [...builtInProfiles[category], ...customProfiles[category]]\n    if (profiles.indexOf(activeProfiles[category]) === -1) {\n      activeProfiles[category] = 'default'\n    }\n  }\n  await storageSet({ activeProfiles })\n}\n\nasync function correctCustomOptions () {\n  const { config, options, categories, customProfiles } = await storageGet([\n    'config',\n    'options',\n    'categories',\n    'customProfiles'\n  ])\n  for (const category of categories) {\n    if (customProfiles[category] === undefined) {\n      customProfiles[category] = []\n    }\n    for (const profile of customProfiles[category]) {\n      const key = `${category}_${profile}`\n      options[key] = correctedOptions(options[key], config[category])\n    }\n  }\n  await storageSet({ options })\n}\n\nfunction correctedOptions (options, config) {\n  const newOptions = {}\n  for (const item of config) {\n    newOptions[item.key] = correctValue(options[item.key], item)\n  }\n  return newOptions\n}\n\n/**\n * If the value conforms to the constraints defined in the config file,\n * returns the value unchanged. Otherwise returns the default value for the option.\n */\nfunction correctValue (value, configItem) {\n  // TODO\n  return value === undefined ? configItem.default : value\n}\n","/* global define */\n(function (root, factory) {\n  /* istanbul ignore next */\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.compareVersions = factory();\n  }\n}(this, function () {\n\n  var semver = /^v?(?:\\d+)(\\.(?:[x*]|\\d+)(\\.(?:[x*]|\\d+)(\\.(?:[x*]|\\d+))?(?:-[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?(?:\\+[\\da-z\\-]+(?:\\.[\\da-z\\-]+)*)?)?)?$/i;\n\n  function indexOrEnd(str, q) {\n    return str.indexOf(q) === -1 ? str.length : str.indexOf(q);\n  }\n\n  function split(v) {\n    var c = v.replace(/^v/, '').replace(/\\+.*$/, '');\n    var patchIndex = indexOrEnd(c, '-');\n    var arr = c.substring(0, patchIndex).split('.');\n    arr.push(c.substring(patchIndex + 1));\n    return arr;\n  }\n\n  function tryParse(v) {\n    return isNaN(Number(v)) ? v : Number(v);\n  }\n\n  function validate(version) {\n    if (typeof version !== 'string') {\n      throw new TypeError('Invalid argument expected string');\n    }\n    if (!semver.test(version)) {\n      throw new Error('Invalid argument not valid semver (\\''+version+'\\' received)');\n    }\n  }\n\n  function compareVersions(v1, v2) {\n    [v1, v2].forEach(validate);\n\n    var s1 = split(v1);\n    var s2 = split(v2);\n\n    for (var i = 0; i < Math.max(s1.length - 1, s2.length - 1); i++) {\n      var n1 = parseInt(s1[i] || 0, 10);\n      var n2 = parseInt(s2[i] || 0, 10);\n\n      if (n1 > n2) return 1;\n      if (n2 > n1) return -1;\n    }\n\n    var sp1 = s1[s1.length - 1];\n    var sp2 = s2[s2.length - 1];\n\n    if (sp1 && sp2) {\n      var p1 = sp1.split('.').map(tryParse);\n      var p2 = sp2.split('.').map(tryParse);\n\n      for (i = 0; i < Math.max(p1.length, p2.length); i++) {\n        if (p1[i] === undefined || typeof p2[i] === 'string' && typeof p1[i] === 'number') return -1;\n        if (p2[i] === undefined || typeof p1[i] === 'string' && typeof p2[i] === 'number') return 1;\n\n        if (p1[i] > p2[i]) return 1;\n        if (p2[i] > p1[i]) return -1;\n      }\n    } else if (sp1 || sp2) {\n      return sp1 ? -1 : 1;\n    }\n\n    return 0;\n  };\n\n  var allowedOperators = [\n    '>',\n    '>=',\n    '=',\n    '<',\n    '<='\n  ];\n\n  var operatorResMap = {\n    '>': [1],\n    '>=': [0, 1],\n    '=': [0],\n    '<=': [-1, 0],\n    '<': [-1]\n  };\n\n  function validateOperator(op) {\n    if (typeof op !== 'string') {\n      throw new TypeError('Invalid operator type, expected string but got ' + typeof op);\n    }\n    if (allowedOperators.indexOf(op) === -1) {\n      throw new TypeError('Invalid operator, expected one of ' + allowedOperators.join('|'));\n    }\n  }\n\n  compareVersions.validate = function(version) {\n    return typeof version === 'string' && semver.test(version);\n  }\n\n  compareVersions.compare = function (v1, v2, operator) {\n    // Validate operator\n    validateOperator(operator);\n\n    // since result of compareVersions can only be -1 or 0 or 1\n    // a simple map can be used to replace switch\n    var res = compareVersions(v1, v2);\n    return operatorResMap[operator].indexOf(res) > -1;\n  }\n\n  return compareVersions;\n}));\n","import browser from 'webextension-polyfill'\n\n/**\n * Given a DOM element, returns true if you can edit it with key presses or\n * if the element is of a type that should handle its own keypresses\n * (e.g. role=application for google docs/sheets)\n * TODO: work on case sensitivity\n * consider all the possible cases\n * @param {HTMLElement} element\n * @returns {boolean}\n */\nexport function isTextEditable (element) {\n  if (element) {\n    switch (element.nodeName) {\n      case 'INPUT':\n        return isEditableHTMLInput(element)\n      case 'TEXTAREA':\n      case 'OBJECT':\n        return true\n    }\n    switch (true) {\n      case element.contentEditable.toUpperCase() === 'TRUE':\n      case element.role === 'application':\n        return true\n    }\n  }\n  return false\n}\n\n/**\n * Returns whether the passed HTML input element is editable\n * @param {HTMLInputElement} element\n */\nfunction isEditableHTMLInput (element) {\n  if (element.disabled || element.readonly) return false\n  switch (element.type) {\n    case undefined:\n    case 'text':\n    case 'search':\n    case 'email':\n    case 'url':\n    case 'number':\n    case 'password':\n    case 'date':\n    case 'tel':\n      return true\n  }\n  return false\n}\n\n/**\n * Like document.activeElement, but penetrates through Shadow DOM\n * A good example is: https://web.archive.org/web/20170621214451/https://material.io/icons/\n * Click on the input. document.activeElement is different from deepActiveElement()\n * @param {HTMLElement} root\n */\nexport function deepActiveElement (root = document) {\n  const activeElement = root.activeElement\n  const activeElementShadowRoot = activeElement && activeElement.shadowRoot\n  return activeElementShadowRoot\n    ? deepActiveElement(activeElementShadowRoot)\n    : activeElement\n}\n\n/**\n * Dispatch a mouse event to the target element\n * based on cVim's implementation\n * @param {HTMLElement} element\n * @param {'hover' | 'unhover' | 'click'} type\n * @param {{ ctrlKey, shiftKey, altKey, metaKey }} modifierKeys\n */\nexport function mouseEvent (element, type, modifierKeys = {}) {\n  let events\n  switch (type) {\n    case 'hover':\n      events = ['mouseover', 'mouseenter', 'mousemove']\n      break\n    case 'unhover':\n      events = ['mousemove', 'mouseout', 'mouseleave']\n      break\n    case 'click':\n      events = ['mouseover', 'mousedown', 'mouseup', 'click']\n      break\n  }\n  events.forEach(type => {\n    const event = new MouseEvent(type, {\n      bubbles: true,\n      cancelable: true,\n      view: window,\n      detail: 1, // usually the click count\n      ...modifierKeys\n    })\n    element.dispatchEvent(event)\n  })\n}\n\n/**\n * TODO: use standard fullscreenchange event when browsers support it\n */\nexport const fullscreenchange =\n  SAKA_PLATFORM === 'chrome'\n    ? 'webkitfullscreenchange'\n    : SAKA_PLATFORM === 'firefox'\n      ? 'mozfullscreenchange'\n      : 'fullscreenchange'\n/**\n * Given a DOM event type that is vendor pre-fixed, e.g. 'mozfullscreenchange',\n * converts it to a standardized event type, e.g. 'fullscreenchange'\n * TODO: remove this if no vendor-prefixed events are needed\n * @param {string} event\n * @returns {string}\n */\nexport function normalizeEventType (type) {\n  switch (type) {\n    case fullscreenchange:\n      return 'fullscreenchange'\n    default:\n      return type\n  }\n}\n\n// TODO: figure out why elements within shadow roots aren't registered as\n// visible/clickable, then start using this method\n/**\n * Given an HTML Element, returns a list of all elements within\n * penetrating the shadow DOM\n * @param {HTMLElement} root\n */\nexport function getAllElementsIncludingShadowDOM (root = document) {\n  const allElements = root.querySelectorAll('*')\n  let shadowDescendents = []\n  allElements.forEach(element => {\n    if (element.shadowRoot) {\n      shadowDescendents = [\n        ...shadowDescendents,\n        ...getAllElementsIncludingShadowDOM(element.shadowRoot)\n      ]\n    }\n  })\n  return [...allElements, shadowDescendents]\n}\n\n/**\n * Copies the specified text to the clipboard\n * @param {string} text\n */\nexport function copy (text) {\n  const textArea = document.createElement('textarea')\n  textArea.style = 'position:fixed;right:0'\n  textArea.value = text\n  document.body.appendChild(textArea)\n  textArea.select()\n  document.execCommand('Copy')\n  document.body.removeChild(textArea)\n}\n\n/**\n * Returns the clipboard contents.\n * This method is only callable from the background page and requires\n * the \"clipboardRead\" permission to be declared in manifest.json\n * @returns {string}\n */\nexport function paste () {\n  const textArea = document.createElement('textarea')\n  textArea.style = 'position:fixed;right:0'\n  document.body.appendChild(textArea)\n  textArea.focus()\n  document.execCommand('Paste')\n  const value = textArea.value\n  document.body.removeChild(textArea)\n  return value\n}\n\n/** Saves the given object to a human-readable JSON file */\nexport async function downloadJSON (object, filename) {\n  const url = URL.createObjectURL(\n    new Blob([JSON.stringify(object, null, 2)], {\n      type: 'data:application/json;charset=utf-8'\n    })\n  )\n  await browser.downloads.download({\n    url,\n    filename,\n    saveAs: true\n  })\n}\n","import browser from 'webextension-polyfill'\n\nexport const storageGet = browser.storage.local.get\nexport const storageSet = browser.storage.local.set\nexport const storageRemove = browser.storage.local.remove\nexport const storageClear = browser.storage.local.clear\n\nexport async function getAllActiveProfileOptions () {\n  const { activeProfiles } = await storageGet('activeProfiles')\n  const { options } = await storageGet('options')\n  const activeOptions = {}\n  for (const [category, profile] of Object.entries(activeProfiles)) {\n    Object.assign(activeOptions, options[`${category}_${profile}`])\n  }\n  return activeOptions\n}\n","import friendlyCodeStrings from './friendlyCodeStrings.json'\nimport { hasProp } from './util'\n\nexport const isMac = navigator.appVersion.indexOf('Mac') !== -1\n\nlet _physicalKeys = true\nlet _ignoreModifierKeys = false\n\n/**\n * Configure how keyboard bindings should be interpreted and displayed\n * Options:\n * 1. physicalKeys = false: use event.code + modifierKeys\n * 2. physicalKeys = true && ignoreModifierKeys = false: use event.key + modifierKeys\n * 3. physicalKeys = true && ignoreModifierKeys = true: use event.key\n * @param {boolean} physicalKeys_\n * @param {boolean} ignoreModifierKeys_\n */\nexport function setKeyboardSettings (physicalKeys, ignoreModifierKeys) {\n  _physicalKeys = physicalKeys\n  _ignoreModifierKeys = ignoreModifierKeys\n}\n\n/**\n * Returns true if the given keyboard event is ONLY a modifier key, false otherwise\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function isModifierKey (event) {\n  switch (event.key) {\n    case 'Shift':\n    case 'Control':\n    case 'Alt':\n    case 'Meta':\n      return true\n    default:\n      return false\n  }\n}\n\n/**\n * Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction modifierString (event) {\n  const { shiftKey: s, ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${s ? 's' : ''}${c ? 'c' : ''}${a ? 'a' : ''}${m ? 'm' : ''}`\n}\n\n/**\n * Converts a KeyboardEvent to its string representation use for internal processing\n * @param {KeyboardEvent} event\n * @param {boolean} physicalKeys\n * @param {boolean} ignoreModifierKeys\n * @returns {string}\n */\nexport function keyboardEventString (\n  event,\n  physicalKeys = _physicalKeys,\n  ignoreModifierKeys = _ignoreModifierKeys\n) {\n  return physicalKeys\n    ? `${modifierString(event)}_${event.code}`\n    : ignoreModifierKeys\n      ? `${event.key}`\n      : `${modifierString(event)}_${event.key}`\n}\n\n/** Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction friendlyModifierString (event) {\n  const { shiftKey: s, ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${s ? 'shift-' : ''}${c ? 'ctrl-' : ''}${a ? 'alt-' : ''}${\n    m ? 'meta-' : ''\n  }`\n}\n\n/** Given a keyboard event, returns a string representation of its modifiers\n * @param {KeyboardEvent} event\n * @returns {string}\n */\nfunction friendlyShiftlessModifierString (event) {\n  const { ctrlKey: c, altKey: a, metaKey: m } = event\n  return `${c ? 'ctrl-' : ''}${a ? 'alt-' : ''}${m ? 'meta-' : ''}`\n}\n\n/** Converts a KeyboardEvent to a user-friendly string representation.\n * @param {KeyboardEvent} event\n * @param {boolean} physicalKeys\n * @param {boolean} ignoreModifierKeys\n * @returns {string}\n */\nexport function friendlyKeyboardEventString (\n  event,\n  physicalKeys = _physicalKeys,\n  ignoreModifierKeys = _ignoreModifierKeys\n) {\n  return physicalKeys\n    ? `${friendlyModifierString(event)}${\n        friendlyCodeStrings[event.code]\n          ? friendlyCodeStrings[event.code].value\n          : event.code\n      }`\n    : ignoreModifierKeys\n      ? `${event.key}`\n      : `${friendlyShiftlessModifierString(event)}${event.key}`\n}\n\n/**\n * Returns whether a (possibly user-defined) keyboard event is valid\n * @param {KeyboardEvent} event\n * @returns {boolean}\n */\nexport function validKeyboardEvent (event) {\n  return (\n    event &&\n    event.key &&\n    typeof event.key === 'string' &&\n    event.code &&\n    typeof event.code === 'string' &&\n    (!hasProp(event, 'shiftKey') ||\n      (event.shiftKey && typeof event.shiftKey === 'boolean')) &&\n    (!hasProp(event, 'ctrlKey') ||\n      (event.ctrlKey && typeof event.ctrlKey === 'boolean')) &&\n    (!hasProp(event, 'altKey') ||\n      (event.altKey && typeof event.altKey === 'boolean')) &&\n    (!hasProp(event, 'metaKey') ||\n      (event.metaKey && typeof event.metaKey === 'boolean'))\n  )\n}\n\n/**\n * Extracts the important attributes from a KeyboardEvent so that\n * the event can be sent as JSON\n * @param {KeyboardEvent} event\n */\nexport function simplify ({\n  key,\n  code,\n  ctrlKey,\n  altKey,\n  metaKey,\n  shiftKey,\n  repeat\n}) {\n  return {\n    key,\n    code,\n    ctrlKey,\n    altKey,\n    metaKey,\n    shiftKey,\n    repeat\n  }\n}\n","/** Returns the _positive_ modulus */\nexport function posMod (n, m) {\n  return ((n % m) + m) % m\n}\n/**\n * Return copy of object that contains only the attributes specified in key array\n *\n * @param {Object} object Object that attributes are copied from\n * @param {String[]} keys String array of attributes to copy\n * @throws {Error} Object does not contain attribute key\n * @returns {Object} Object that contains only the attributes specified in key array\n */\nexport function getAttributes (object, keys) {\n  const output = {}\n  keys.forEach(key => {\n    if (hasProp(object, key)) {\n      output[key] = object[key]\n    } else {\n      throw Error(`object has no attribute ${key}`)\n    }\n  })\n  return output\n}\n\n/**\n * Check if an object has a given property\n * @param {Object} object Object to check\n * @param {String} prop String property to check\n */\nexport function hasProp (object, prop) {\n  return Object.prototype.hasOwnProperty.call(object, prop)\n}\n\nexport function objectMap (object, map) {\n  const out = {}\n  Object.entries(object).forEach(([attribute, value]) => {\n    out[attribute] = map(value)\n  })\n  return out\n}\n","import { Node, Transactions, DEFAULT_TIMEOUT } from './node';\nclass Client extends Node {\n  constructor () {\n    super(...arguments);\n    this.timeout = 1000;\n    this.transactions = new Transactions();\n    this.init = ({ subscriptions = [], onConnect = [], onDisconnect = [], actions, log = false, onClientDisconnect }) => {\n      this.initLogging(log);\n      this.subscriptions = subscriptions;\n      this.actions = actions;\n      this.onConnect = onConnect;\n      this.onDisconnect = onDisconnect;\n      this.onClientDisconnect = onClientDisconnect;\n      this.connect();\n            // firefox doesn't fire port.onDisconnect on the background page for navigation\n            // events so every content script must manually call port.disconnect() on unload\n            // TODO: remove this event listener when the following bug is fixed\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1370368\n      window.addEventListener('beforeunload', () => {\n        this.port.disconnect();\n      });\n    };\n    this.connect = () => {\n      const { subscriptions: subs, onConnect, onDisconnect } = this;\n      const connectionInfo = { name: JSON.stringify({ subs, onConnect, onDisconnect }) };\n      this.port = chrome.runtime.connect(connectionInfo);\n      this.port.onDisconnect.addListener(this.disconnectListener);\n      this.port.onMessage.addListener(this.messageListener);\n    };\n        /**\n         * If the current node is the only target, immediately execute the\n         * action locally, otherwise forward the message to the background\n         * page.\n         * Doesn't send src id because only background page populates src id.\n         */\n    this.msg = (dst, action, arg) => {\n      if (dst === 0) {\n        this.actionHandler(action, arg, 0);\n      } else {\n        this.log('Tx', 'msg', 0, dst, action, arg);\n        this.port.postMessage({ t: 'msg', dst, action, arg });\n      }\n    };\n    this._getLocal = async (localId, src, action, arg) => {\n      try {\n        return { id: localId, v: await this.actionHandler(action, arg, src) };\n      } catch (error) {\n        return { id: localId, e: error };\n      }\n    };\n    this._getRemote = (dst, action, arg, timeout) => new Promise((resolve, reject) => {\n      const tid = this.transactions.new(resolve, reject, timeout);\n      this.log('Tx', 'get', 0, dst, action, arg, tid);\n      this.port.postMessage({ t: 'get', dst, action, arg, tid, timeout });\n    });\n        /**\n         * localId is the id of the current node\n         * localId will be set to 0 if called locally\n         * localId will be set to the node's global id if called from some other node\n         */\n    this.get = async (dst, action, arg, timeout = DEFAULT_TIMEOUT) => {\n      return (dst === 0)\n                ? [await this._getLocal(0, 0, action, arg)]\n                : await this._getRemote(dst, action, arg, timeout);\n    };\n    this.disconnectListener = (port) => {\n      this.onClientDisconnect && this.onClientDisconnect();\n    };\n        /**\n         * Although client nodes don't include a src id when sending messsages,\n         * because it is the bp's duty to populate the src id,\n         * incoming messages MUST have a src id.\n         * t is the message class\n         * If a client node receives a message, it must be an intended destination\n         */\n    this.messageListener = ({ src, dst, t, action, arg, tid, res }) => {\n      switch (t) {\n        case 'msg':\n          this.log('Rx', 'msg', src, dst, action, arg);\n          this.actionHandler(action, arg, src);\n          break;\n        case 'get':\n          this.log('Rx', 'get', src, dst, action, arg, tid);\n          this._getLocal(dst, src, action, arg)\n                        .then((res) => {\n                          try {\n                            this.log('Tx', 'rsp', src, dst, action, res, tid);\n                            this.port.postMessage({ t: 'rsp', src: dst, dst: src, action, tid, res });\n                          } catch (e) { } // the port may disconnect if the user navigated to a new page\n                        }).catch((e) => {\n                          try {\n                            this.log('Tx', 'rsp', src, dst, action, res, tid);\n                            this.port.postMessage({ t: 'rsp', src: dst, dst: src, action, tid, res: { e } });\n                          } catch (e) { }\n                        });\n          break;\n        case 'rsp':\n          this.log('Rx', 'rsp', src, dst, action, res, tid);\n          this.transactions.complete(tid, res);\n          break;\n        default:\n          console.error(`ERROR: Invalid message class: ${t}`);\n          break;\n      }\n    };\n  }\n}\nconst node = new Client();\nconst init = node.init;\nconst msg = node.msg;\nconst get = node.get;\nexport { init, msg, get };\n","import { Node, Transactions, DEFAULT_TIMEOUT } from './node';\nclass Connections {\n  constructor () {\n    this.connectionsByPort = new Map();\n    this.connectionsById = new Map();\n    this.nextId = 2;\n        /** Adds new connection, returning its id */\n    this.add = (port, subs, onDisconnect) => {\n            /** browser action, page actions, devtools won't have tabId or frameId */\n      const sender = port.sender;\n      let tabId;\n      if (sender.tab) { tabId = sender.tab.id; }\n      const frameId = sender.frameId;\n            /** client ids start at 2: 0 refers to self, 1 refers to core */\n      const id = this.nextId++;\n      const transactions = new Transactions();\n      const connection = { port, id, subs, onDisconnect, tabId, frameId, transactions, sender, data: {} };\n      this.connectionsByPort.set(port, connection);\n      this.connectionsById.set(id, connection);\n      return id;\n    };\n    this.remove = (port) => {\n      const connection = this.connectionsByPort.get(port);\n            // This code will clean up a connections transactions on removal, consider adding it back\n            // instead of relying on timeouts.\n            // const transactions = connection.transactions.transactions;\n            // for (const tid in transactions) {\n            //     connection.transactions.delete(tid);\n            // }\n      this.connectionsById.delete(connection.id);\n      this.connectionsByPort.delete(port);\n    };\n        /** execute callback in context of a temporary connection, used for light-client */\n    this.withTmpConnection = async (sender, callback) => {\n      let tabId;\n      if (sender.tab) { tabId = sender.tab.id; }\n      const frameId = sender.frameId;\n      const id = this.nextId++;\n      const transactions = new Transactions();\n      const connection = { id, subs: [], onDisconnect: [], tabId, frameId, transactions, sender, data: {} };\n      this.connectionsById.set(id, connection);\n      await callback(id);\n      this.connectionsById.delete(id);\n    };\n    this.getByPort = (port) => this.connectionsByPort.get(port);\n    this.getById = (id) => this.connectionsById.get(id);\n  }\n}\nclass Core extends Node {\n  constructor () {\n    super();\n    this.connections = new Connections();\n        /**\n         * The background page doubles as the Communication Administrator. It must:\n         * 1. Run its own onConnect actions on init.\n         * 2. Run every other node's onConnect actions when they connect.\n         * 3. Run every other node's onDisconnect actions when they disconnect.\n         * 4. Never execute its own onDisconnect handlers because it should never disconnect.\n         * 5. Maintain information about itself.\n         * 6. Maintain information about active connections.\n         */\n    this.init = ({ subscriptions = [], onConnect = [], onDisconnect = [], actions, log = false }) => {\n      this.initLogging(log);\n      this.subscriptions = subscriptions;\n      this.actions = actions;\n      chrome.runtime.onConnect.addListener((port) => {\n        const { subs, onConnect: onC, onDisconnect: onD } = JSON.parse(port.name);\n        const id = this.connections.add(port, subs, onD);\n        port.onDisconnect.addListener(this.disconnectListener);\n        port.onMessage.addListener(this.messageListener);\n        this.executeOnConnectionActions(id, onC);\n      });\n      this.executeOnConnectionActions(0, onConnect);\n    };\n    this.executeOnConnectionActions = (src, actionDetails) => {\n      actionDetails.forEach(({ action, arg, dst = 0 }) => {\n        this._msg(src, dst, action, arg);\n      });\n    };\n    this.getTargets = (src, dst) => {\n      let targetSelf = false;\n      let targets = [];\n      if (typeof dst === 'number') {\n        if (dst === 0 || dst === 1) {\n          targetSelf = true;\n        } else {\n          const target = this.connections.getById(dst);\n          if (!target) {\n            console.error('ERROR: attempted to message non-existent client');\n          } else if (target.closed) {\n            console.error('ERROR: attempted to message over closed connection');\n          } else {\n            targets = [target];\n          }\n        }\n      } else if (typeof dst === 'string') {\n        targetSelf = this.subscriptions.includes(dst);\n        targets = this.getStringTargets(src, dst);\n      } else {\n        console.error('ERROR: dst type is invalid');\n      }\n      return [targetSelf, targets];\n    };\n        /**\n         * If the destination includes the current node, execute the action locally.\n         * Also send an action message to every other destination node.\n         * TODO: CLEAN THIS UP\n         */\n    this._msg = (src, dst, action, arg) => {\n      const [targetSelf, targets] = this.getTargets(src, dst);\n      if (targetSelf) { this.actionHandler(action, arg, src); }\n      targets.forEach(({ port }) => {\n        if (port) {\n          this.log('Tx', 'msg', src, dst, action, arg);\n          port.postMessage({ t: 'msg', src, dst, action, arg });\n        } else {\n          throw Error('No messaging light-clients');\n        }\n      });\n    };\n    this.msg = this._msg.bind(undefined, 1);\n        /**\n         * A destination is composed of multiple subdestinations separated by semicolons.\n         * A connection receives a message if it is part of any subdestination.\n         * A subdestination is composed of multiple conditions separated by periods.\n         * A connection is part of a subdestination if it satisfies all its conditions.\n         * This is conceptually akin to a conjunctive normal form (OR of AND) boolean formula.\n         * getStringTargets should not include the local node as that is handled by a separate\n         * local action handler.\n         */\n    this.getStringTargets = (src, dst) => {\n            /** Returns true if the given connection is part of the destination, else false */\n      const predicate = (connection) => {\n        if (connection.closed) { return false; }\n        for (const subDst of dst.split('|')) {\n          const allConditionsMet = subDst.split('&').map((condition) => {\n            if (connection.subs.includes(condition)) {\n              return true;\n            }\n            if (condition === 'topFrame') {\n              return connection.frameId === 0;\n            }\n            if (condition === 'childFrames') {\n              return connection.frameId !== 0;\n            }\n            if (condition === 'otherFrames') {\n              return connection.frameId !== this.connections.getById(src).frameId;\n            }\n            if (condition === 'thisTab') {\n              return connection.tabId === this.connections.getById(src).tabId;\n            }\n            if (condition === 'other') {\n              return connection.id !== this.connections.getById(src).id;\n            }\n            const tabCondition = condition.match(/tab\\[(\\d+)\\]/);\n            if (tabCondition) {\n              return connection.tabId === parseInt(tabCondition[1], 10);\n            }\n            const frameCondition = condition.match(/frame\\[(\\d+)\\]/);\n            if (frameCondition) {\n              return connection.frameId === parseInt(frameCondition[1], 10);\n            }\n            const idCondition = condition.match(/id\\[(\\d+)\\]/);\n            if (idCondition) {\n              return connection.id === parseInt(idCondition[1], 10);\n            }\n            return false;\n          }).every((conditionMet) => conditionMet);\n          if (allConditionsMet) { return true; }\n        }\n        return false;\n      };\n            // TODO: review perfomance cost of array conversion, perhaps rewrite to avoid conversion\n      return [...this.connections.connectionsById.values()].filter(predicate);\n    };\n    this._getLocal = async (src, action, arg) => {\n      try {\n        return { id: 1, v: await this.actionHandler(action, arg, src) };\n      } catch (error) {\n        return { id: 1, e: error };\n      }\n    };\n    this._getRemote = (connection, src, action, arg, timeout) => {\n      return new Promise((resolve, reject) => {\n        const tid = connection.transactions.new(resolve, reject, timeout);\n        if (connection.port) {\n          this.log('Tx', 'get', src, connection.id, action, arg, tid);\n          connection.port.postMessage({ t: 'get', src, dst: connection.id, action, arg, tid });\n        } else {\n          throw Error('No messaging light-clients');\n        }\n      });\n    };\n    this._get = (src, dst, action, arg, timeout = DEFAULT_TIMEOUT) => {\n      const [targetSelf, targets] = this.getTargets(src, dst);\n      const localResult = (targetSelf)\n                ? [this._getLocal(src, action, arg)]\n                : [];\n      const remoteResults = targets.map((target) => {\n        return this._getRemote(target, src, action, arg, timeout);\n      });\n            // TODO: Proper Promise handling (don't fail if any fails)\n      try {\n        return Promise.all([...localResult, ...remoteResults]);\n      } catch (e) {\n        console.error(e, 'connections: ', this.connections);\n        return Promise.resolve([]);\n      }\n    };\n    this.get = this._get.bind(undefined, 1);\n        /**\n         * Executes onDisconnt actions and deletes data associated with connection.\n         * Connection is marked as closed so that no messages are sent to it when executing\n         * onDisconnect actions.\n         */\n    this.disconnectListener = (port) => {\n      const connection = this.connections.getByPort(port);\n      connection.closed = true;\n      this.executeOnConnectionActions(connection.id, connection.onDisconnect);\n      this.connections.remove(port);\n    };\n        /**\n         * Handles messages on receipt by calling the appropriate internal function\n         */\n    this.messageListener = ({ src, dst, t, action, arg, tid, res, timeout }, port) => {\n      if (src === undefined) { src = this.connections.getByPort(port).id; }\n      switch (t) {\n        case 'msg':\n          this.log('Rx', 'msg', src, dst, action, arg);\n          this._msg(src, dst, action, arg);\n          break;\n        case 'get':\n          this.log('Rx', 'get', src, dst, action, arg, tid);\n          this._get(src, dst, action, arg, timeout).then((result) => {\n            this.log('Tx', 'rsp', src, dst, action, result, tid);\n            port.postMessage({ t: 'rsp', src: dst, dst: src, action, res: result, tid });\n          }).catch((e) => {\n            this.log('Tx', 'rsp', src, dst, action, { e }, tid);\n            port.postMessage({ t: 'rsp', src: dst, dst: src, action, res: { e }, tid });\n          });\n          break;\n        case 'rsp':\n          this.log('Rx', 'rsp', src, dst, action, res, tid);\n          const connection = this.connections.getByPort(port);\n          if (connection) {\n            connection.transactions.complete(tid, res);\n          }\n                    // the code may get here if a transaction is received over a connection\n                    // that subsequently closed. Do nothing, a timeout will trigger the\n                    // reject handler automatically.\n          break;\n        default:\n          throw Error(`Invalid message class: ${t}`);\n      }\n    };\n    this.meta = (connectionId) => {\n      const connection = this.connections.getById(connectionId);\n      if (connection) {\n        return {\n          frameId: connection.frameId,\n          tabId: connection.tabId,\n          sender: connection.sender,\n          subs: connection.subs,\n          data: connection.data\n        };\n      }\n      return undefined;\n    };\n        /** adds a listener for light-client messages */\n    chrome.runtime.onMessage.addListener(({ mosi_lw_msg, dst, action, arg }, sender) => {\n      if (mosi_lw_msg) {\n        this.log('Rx', 'msg', 'lw_client', dst, action, arg);\n        this.connections.withTmpConnection(sender, async (connectionId) => {\n          await this._msg(connectionId, dst, action, arg);\n        });\n      }\n    });\n  }\n}\nconst node = new Core();\nconst init = node.init;\nconst msg = node.msg;\nconst get = node.get;\nconst meta = node.meta;\nexport { init, msg, meta, get };\n","import { msg, meta } from 'mosi/core'\nimport { getAllActiveProfileOptions, storageGet } from 'storage/storage'\nimport transformOptions from 'storage/transform'\nimport {\n  storageInstallProcedure,\n  storageUpdateProcedure\n} from 'storage/procedures'\nimport browser from 'webextension-polyfill'\n\nexport let modes = {}\n\nconst defaultModeObject = {\n  onOptionsChange: () => {},\n  messages: {}\n}\n\nexport function initModes (availableModes, actions) {\n  modes = availableModes\n  Object.entries(availableModes).map(([name, mode]) => {\n    modes[name] = Object.assign({}, defaultModeObject, mode)\n    Object.assign(actions, modes[name].messages)\n  })\n}\n\nexport async function loadClient (_, src) {\n  const {\n    sender: {\n      frameId,\n      tab: { index: tabIndex, id: tabId }\n    }\n  } = meta(src)\n  // tabIndex === -1 indicates the tab is preloaded but not a full tab\n  // attempting to execute into it is an error\n  // https://stackoverflow.com/questions/43665470/cannot-call-chrome-tabs-executescript-into-preloaded-tab-is-this-a-bug-in-chr\n  if (tabIndex === -1) {\n    if (SAKA_DEBUG) {\n      console.log(\n        `NOT loading client into preloaded tab: frame: ${frameId}, tab: ${tabId}`\n      )\n    }\n  } else {\n    if (SAKA_DEBUG) {\n      console.log(`Loading client: frame: ${frameId}, tab: ${tabId}`)\n    }\n    await browser.tabs.executeScript(tabId, {\n      file: 'content_script.js',\n      frameId,\n      runAt: 'document_start',\n      matchAboutBlank: true\n    })\n  }\n}\n\n/** Reloads all Saka Clients, called on extension updates */\nexport async function reloadAllClients () {\n  const tabs = await browser.tabs.query({})\n  console.log(tabs)\n  try {\n    await Promise.all(\n      tabs.filter(isTabExecutable).map(tab =>\n        browser.tabs.executeScript(tab.id, {\n          file: 'content_script_loader.js',\n          allFrames: true,\n          runAt: 'document_start',\n          matchAboutBlank: true\n        })\n      )\n    )\n  } catch (error) {\n    // it's normal for certain tabs to not load\n    console.log('Failed to reload client into all tabs')\n  }\n}\n\nconst EXTENSION_PROTOCOL = browser.runtime.getURL('').split(':')[0] + '://'\n\nfunction isTabExecutable (tab) {\n  if (tab.url === 'about:blank') return true\n  if (tab.url.startsWith('about:')) return false\n  if (tab.url.startsWith(EXTENSION_PROTOCOL)) return false\n  return true\n}\n\n// Requests for the full Saka Client by the client loaders of preloaded tabs are\n// denied because attempting to execute within them would cause errors.\n// https://stackoverflow.com/questions/43665470/cannot-call-chrome-tabs-executescript-into-preloaded-tab-is-this-a-bug-in-chr\n// Instead, the background page listens for the tabs.onReplaced event and executes\n// content_script_loader.js into all frames, which then launches another request for\n// the full Saka Client\nif (SAKA_PLATFORM === 'chrome') {\n  chrome.tabs.onReplaced.addListener(async (addedTabId, removedTabId) => {\n    if (SAKA_DEBUG) {\n      console.log(\n        `Tab id changed from ${removedTabId} to ${addedTabId}. Reloading content_script_loader.js`\n      )\n    }\n    await browser.tabs.executeScript(addedTabId, {\n      file: 'content_script_loader.js',\n      allFrames: true,\n      runAt: 'document_start',\n      matchAboutBlank: true\n    })\n  })\n}\n\nlet cachedClientOptions\n\nexport function clientOptions (arg, src) {\n  msg(src, 'clientOptions', cachedClientOptions)\n}\n\nasync function onOptionsChange () {\n  if ((await storageGet('ready')).ready) {\n    const { backgroundOptions, clientOptions } = transformOptions(\n      await getAllActiveProfileOptions(),\n      (await storageGet('config')).config\n    )\n    Object.values(modes).forEach(mode => {\n      mode.onOptionsChange(backgroundOptions)\n    })\n    cachedClientOptions = clientOptions\n    msg('client', 'clientOptions', clientOptions)\n  }\n}\n\nchrome.storage.onChanged.addListener(onOptionsChange)\n\n/**\n * Sets up startup listener, sets up install listener, and executes setup routine\n * When an extension is installed, only the install listener is executed, not the\n * startup listener. The startup listener is called only when chrome is opened.\n * The install listener can be called for a number of reasons.\n * A setup action that should always run whenever the background page starts\n * should NOT be placed in the startup listener.\n */\nexport async function setup () {\n  await initInstallListeners()\n  await onOptionsChange()\n}\n\nfunction initInstallListeners () {\n  chrome.runtime.onInstalled.addListener(\n    async ({ reason, previousVersion }) => {\n      if (SAKA_DEBUG) console.log('install event: ' + reason)\n      switch (reason) {\n        case 'install':\n          await storageInstallProcedure()\n          await onOptionsChange()\n          await reloadAllClients()\n          chrome.tabs.create({ url: 'info.html' })\n          break\n        case 'update':\n          await storageUpdateProcedure(previousVersion)\n          await onOptionsChange()\n          await reloadAllClients()\n          // TODO: Replace with Notification\n          // chrome.tabs.create({ url: 'info.html' });\n          break\n        case 'chrome_update':\n        case 'shared_module_update':\n        default:\n          break\n      }\n    }\n  )\n}\n","import { posMod } from 'lib/util'\nimport browser from 'webextension-polyfill'\n\n/** Activate the tab to the right of the active tab of the current window */\nexport async function nextTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const nextTabId = tabs[posMod(activeTabIndex + 1, tabs.length)].id\n  await browser.tabs.update(nextTabId, { active: true })\n}\n\n/** Activate the tab to the left of the active tab of the current window */\nexport async function previousTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const previousTabId = tabs[posMod(activeTabIndex - 1, tabs.length)].id\n  await browser.tabs.update(previousTabId, { active: true })\n}\n\n/** Activate the first tab of the current window */\nexport async function firstTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const firstTabId = tabs[0].id\n  await browser.tabs.update(firstTabId, { active: true })\n}\n\n/** Activate the last tab of the current window */\nexport async function lastTab () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const lastTabId = tabs[tabs.length - 1].id\n  await browser.tabs.update(lastTabId, { active: true })\n}\n\n/** Move the active tab of the current window left */\nexport async function moveTabLeft () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: tab.index - 1 })\n}\n\n/** Move the active tab of the current window right */\nexport async function moveTabRight () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  const nextTabIndex = posMod(activeTabIndex + 1, tabs.length)\n  await browser.tabs.move(tabs[activeTabIndex].id, { index: nextTabIndex })\n}\n\n/** Move the active tab of the current window to the far left */\nexport async function moveTabFirst () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: 0 })\n}\n\n/** Move the active tab of the current window to the far right */\nexport async function moveTabLast () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.move(tab.id, { index: -1 })\n}\n\n/** Move the active tab of the current window to a new window */\nexport async function moveTabNewWindow () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.windows.create({ tabId: tab.id })\n}\n\n/** Close the active tab of the current window */\nexport async function closeTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.remove(tab.id)\n}\n\n/** Close all tabs of the current window except the active tab */\nexport async function closeOtherTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  await Promise.all(\n    tabs.map(async tab => {\n      if (!tab.active) await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Close all tabs to the right of the active tab of the current window */\nexport async function closeRightTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  await Promise.all(\n    tabs.slice(activeTabIndex + 1).map(async tab => {\n      await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Close all tabs to the left of the active tab of the current window */\nexport async function closeLeftTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  const activeTabIndex = tabs.findIndex(tab => tab.active)\n  await Promise.all(\n    tabs.slice(0, activeTabIndex).map(async tab => {\n      await browser.tabs.remove(tab.id)\n    })\n  )\n}\n\n/** Create and activate a new tab */\nexport async function newTab () {\n  await browser.tabs.create({})\n}\n\n/** Reopen and activate the last closed tab */\nexport async function restoreTab () {\n  await browser.sessions.restore()\n}\n\n/** Duplicate and activate the active tab of the current window */\nexport async function duplicateTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.duplicate(tab.id)\n}\n\n/** Duplicate and activate the active tab of the current window incognito */\nexport async function duplicateTabIncognito () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  if (tab.incognito) {\n    await browser.tabs.duplicate(tab.id)\n  } else {\n    const activeWindows = await browser.windows.getAll({\n      windowTypes: ['normal']\n    })\n    const incognitoWindows = activeWindows.filter(w => w.incognito)\n    if (incognitoWindows.length > 0) {\n      await browser.tabs.create({\n        url: tab.url,\n        windowId: incognitoWindows[0].id\n      })\n    } else {\n      await browser.windows.create({\n        url: tab.url,\n        incognito: true,\n        state: 'maximized'\n      })\n    }\n  }\n}\n\n/** Create a new window */\nexport async function newWindow () {\n  await browser.windows.create()\n}\n\n/** Create a new incognito window */\nexport async function newIncognitoWindow () {\n  await browser.windows.create({ incognito: true })\n}\n\n/** Activate the next window */\nexport async function switchWindow () {\n  // TODO: Implement\n  console.error('switchWindow not implemented')\n}\n\nconst zoomStep = 10 // for 10%\n\n/** Zoom in the active tab of the current window */\nexport async function zoomIn () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  const zoomFactor = await browser.tabs.getZoom()\n  await browser.tabs.setZoom(tab.id, Math.min(zoomFactor + zoomStep / 100, 3.0))\n}\n\n/** Zoom out the active tab of the current window */\nexport async function zoomOut () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  const zoomFactor = await browser.tabs.getZoom()\n  await browser.tabs.setZoom(tab.id, Math.max(zoomFactor - zoomStep / 100, 0.3))\n}\n\n/** Reset the zoom of the active tab of the current window */\nexport async function zoomReset () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.setZoom(tab.id, 0)\n}\n\n/** Refresh the active tab of the current window */\nexport async function refreshTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.reload(tab.id)\n}\n\n/** Refresh all tabs of the current window */\nexport async function refreshAllTabs () {\n  const tabs = await browser.tabs.query({ currentWindow: true })\n  await Promise.all(\n    tabs.map(async tab => {\n      await browser.tabs.reload(tab.id)\n    })\n  )\n}\n\n/** Hard refreshes the active tab of the current window */\nexport async function hardRefreshTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.reload(tab.id, { bypassCache: true })\n}\n\n/** Toggle the mute state of the active tab of the current window */\nexport async function toggleMuteTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.update(tab.id, { muted: !tab.mutedInfo.muted })\n}\n\nlet muted = false\n\n/** Mute all tabs of all windows */\nexport async function toggleMuteAllTabs () {\n  muted = !muted\n  const tabs = await browser.tabs.query({})\n  await Promise.all(\n    tabs.map(async tab => {\n      await browser.tabs.update(tab.id, { muted })\n    })\n  )\n}\n\n/** Toggle the pin state of the active tab of the current window */\nexport async function togglePinTab () {\n  const [tab] = await browser.tabs.query({ currentWindow: true, active: true })\n  await browser.tabs.update(tab.id, { pinned: !tab.pinned })\n}\n","import { searchURL } from 'lib/url'\nimport { paste } from 'lib/dom'\nimport browser from 'webextension-polyfill'\n\nexport async function clipboardCurrentTab () {\n  await browser.tabs.update({ url: searchURL(paste()) })\n}\n\nexport async function clipboardBackgroundTab () {\n  await browser.tabs.create({ url: searchURL(paste()), active: false })\n}\n\nexport async function clipboardForegroundTab () {\n  await browser.tabs.create({ url: searchURL(paste()) })\n}\n\nexport async function clipboardNewWindow () {\n  await browser.windows.create({ url: searchURL(paste()) })\n}\n\nexport async function clipboardIncognitoWindow () {\n  await browser.windows.create({ url: searchURL(paste()), incognito: true })\n}\n","import * as tabCommands from './commands/tab'\nimport * as clipboardCommands from './commands/clipboard'\n\nexport default {\n  messages: {\n    ...tabCommands,\n    ...clipboardCommands\n  }\n}\n","import browser from 'webextension-polyfill'\nimport { msg, get, meta } from 'mosi/core'\nimport { generateHintStrings } from './hintStrings'\n\nlet hintChars = 'adsfghjkl;'\nlet autoActivateHint = false\n\nexport default {\n  onOptionsChange: options => {\n    hintChars = options.hintChars.length >= 2 ? options.hintChars : 'bad'\n    autoActivateHint = options.autoActivateHint\n  },\n  messages: {\n    findHints: async (config, src) => {\n      // Gather the number of hintable elements in each frame\n      const currentTabTarget = `tab[${meta(src).tabId}]|id[${src}]`\n      const hintsPerFrame = await get(currentTabTarget, 'findHints', config)\n      const totalHints = hintsPerFrame.reduce((total, { v }) => total + v, 0)\n      // If no hints, immediately exit Hints mode\n      if (totalHints === 0) {\n        msg(currentTabTarget, 'exitHintsMode')\n        // If exactly one hint, immediately activate it (if autoactivation enabled by user)\n      } else if (totalHints === 1 && autoActivateHint) {\n        const { id } = hintsPerFrame.find(({ v, id }) => v === 1)\n        const [{ v: nextMode }] = await get(id, 'activateFirstHint')\n        msg(currentTabTarget, 'exitHintsMode', nextMode)\n        // If multiple hints, trigger hint rendering\n      } else {\n        const hintStrings = generateHintStrings(hintChars, totalHints)\n        let offset = 0\n        hintsPerFrame.forEach(({ id, v }) => {\n          const nextOffset = offset + v\n          msg(id, 'renderHints', hintStrings.slice(offset, nextOffset))\n          offset = nextOffset\n        })\n      }\n    },\n    processKey: async (event, src) => {\n      const currentTabTarget = `tab[${meta(src).tabId}]|id[${src}]`\n      try {\n        const results = await get(currentTabTarget, 'advanceHints', event)\n        if (results.every(({ v }) => v === 'Filtered')) {\n          msg(currentTabTarget, 'exitHintsMode')\n          return\n        }\n        const nextMode = results.find(\n          ({ v }) => v !== 'Same' && v !== 'Filtered' && v !== undefined\n        )\n        if (nextMode) {\n          msg(currentTabTarget, 'exitHintsMode', nextMode.v)\n        }\n      } catch (e) {}\n    },\n    openLinkInIncognitoWindow: url => {\n      // TODO: consider more robust URL verification like Vimium's\n      browser.windows.create({ url, incognito: true })\n    },\n    // Needed to activate links on firefox because it ignores keyboard modifiers\n    // or doesn't execute default behaviors on click events\n    ...(SAKA_PLATFORM === 'chrome'\n      ? {}\n      : {\n        openLinkInBackgroundTab: url => {\n          const arg = {\n            url: url,\n            active: false\n          }\n          browser.tabs\n            .query({ currentWindow: true, active: true })\n            .then(t => {\n              arg.cookieStoreId = t[0].cookieStoreId\n            })\n            .finally(() => {\n              browser.tabs.create(arg)\n            })\n        },\n        openLinkInForegroundTab: url => {\n          const arg = {\n            url: url,\n            active: true\n          }\n          browser.tabs\n            .query({ currentWindow: true, active: true })\n            .then(t => {\n              arg.cookieStoreId = t[0].cookieStoreId\n            })\n            .finally(() => {\n              browser.tabs.create(arg)\n            })\n        },\n        openLinkInNewWindow: url => {\n          const arg = {\n            url: url\n          }\n          browser.tabs\n            .query({ currentWindow: true, active: true })\n            .then(t => {\n              arg.cookieStoreId = t[0].cookieStoreId\n            })\n            .finally(() => {\n              browser.windows.create(arg)\n            })\n        }\n      })\n  }\n}\n","export function generateHintStrings (characters, count) {\n  const hints = ['']\n  let offset = 0\n  while (hints.length - offset < count || hints.length === 1) {\n    const hint = hints[offset++]\n    for (const c of characters) {\n      hints.push(hint + c)\n    }\n  }\n  return hints.slice(offset, offset + count)\n}\n","// import browser from 'lib/browser_polyfill'\nimport { init } from 'mosi/core'\nimport {\n  loadClient,\n  initModes,\n  setup,\n  clientOptions\n} from 'background_page/modes'\nimport Command from 'modes/command/background'\nimport Hints from 'modes/hints/background'\n\nif (SAKA_DEBUG) {\n  console.log('background page initialize begin')\n}\n\n// messaging endpoints, see Mosi (https://github.com/eejdoowad/mosi)\nconst actions = {\n  loadClient,\n  clientOptions\n}\n\n// initialize messaging system\ninit({\n  log: SAKA_DEBUG,\n  actions\n})\n\ninitModes(\n  {\n    Command,\n    Hints\n  },\n  actions\n)\n\nsetup()\n\nif (SAKA_DEBUG) {\n  console.log(`background page initialized for version ${SAKA_VERSION}`)\n}\n",";\nexport const DEFAULT_TIMEOUT = 5000;\nexport class Transactions {\n  constructor () {\n    this.tid = 0;\n    this.transactions = {};\n    this.new = (resolve, reject, timeout) => {\n      const tid = ++this.tid;\n      const timer = setTimeout(() => {\n        delete this.transactions[tid];\n        reject(`Transaction ${tid} timed out.`);\n      }, timeout);\n      this.transactions[tid] = { resolve, reject, timer };\n      return tid;\n    };\n    this.complete = (tid, res) => {\n            // The transaction may have already timed out, so check if it still exists\n      const transaction = this.transactions[tid];\n      if (transaction) {\n        transaction.resolve(res);\n        clearTimeout(transaction.timer);\n        delete this.transactions[tid];\n      }\n    };\n  }\n}\nexport class Node {\n  constructor () {\n    this.actionHandler = (action, arg, src) => {\n      const handler = this.actions[action];\n      if (handler) { return handler(arg, src); }\n      throw Error(`No handler for action ${action}`);\n    };\n    this.initLogging = (log) => {\n      this.log = log\n                ? (tx_or_rx, type, src, dst, action, arg_or_res, tid) => {\n                  const arg_str = type === 'rsp' ? 'res' : 'arg';\n                  const tid_str = tid === undefined ? '' : `:${tid}`;\n                  console.log(`%c${tx_or_rx}%c[%c${type}%c${tid_str}](${src} -> ${dst}) :: %c${action}%c, ${arg_str}=`, `color: ${tx_or_rx === 'Tx' ? 'green' : 'red'}`, 'color: auto', `color: ${type === 'get' ? 'blueviolet' : type === 'msg' ? 'blue' : 'brown'}`, 'color: auto', 'color: teal', 'color: auto', arg_or_res);\n                }\n                : () => { };\n    };\n  }\n}\n"],"sourceRoot":""}